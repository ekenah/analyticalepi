<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Matching in Cohort and Case-Control Studies – Analytical Epidemiology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./outcomereg.html" rel="next">
<link href="./stratification.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-747bc48f972f7c4036e4d8e8c6d9e55a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
  window.MathJax = {
    loader: {load: ['[tex]/centernot']},
    tex: {
      macros: {
        A: "\\mathcal\{A\}",
        approxsim: "\\stackrel\{\\text\{approx\}\}\{\\sim\}",
        AR: "\\text\{AR\}",
        B: "\\mathcal\{B\}",
        Bernoulli: ["\\operatorname\{Bernoulli\}"],
        binomial: ["\\operatorname\{binomial\}"],
        C: "\\mathcal\{C\}",
        chisqH: "\\chi^2_\\text\{H\}",
        chisqP: "\\chi^2_\\text\{P\}",
        chisqPobs: "\\chi^2_\\text\{Pobs\}",
        cHR: "\\text\{cHR\}",
        CHR: "\\text\{CHR\}",
        cloglog: ["\\operatorname\{cloglog\}"],
        comp: "\\mathsf\{C\}",
        Cov: ["\\operatorname\{Cov\}"],
        crude: "\\text\{crude\}",
        D: "\\mathcal\{D\}",
        data: "\\text\{data\}",
        dif: "\\text\{d\}",
        Dminus: "\\text\{D\}^-",
        Dplus: "\\text\{D\}^+",
        E: ["\\operatorname\{\\mathbb\{E\}\}"],
        ESSR: "\\text\{ESSR\}",
        expit: ["\\operatorname\{expit\}"],
        given: ["\\, #1| \\, ", 1],
        HR: "\\text\{HR\}",
        indep: "\\perp\\!\\!\\!\\perp",
        indicator: "\\mathbb\{1\}",
        IRR: "\\text\{IRR\}",
        K: "\\mathcal\{K\}",
        logit: ["\\operatorname\{logit\}"],
        margins: "\\text\{margins\}",
        obs: "\\text\{obs\}",
        odds: ["\\operatorname\{odds\}"],
        OR: "\\text\{OR\}",
        pa: "\\text\{pa\}",
        PAR: "\\text\{PAR\}",
        pcrude: "p^*\_\\text\{crude\}",
        pmarg: "p\_\\text\{marg\}",
        Prstd: "\\Pr\\nolimits\_\\text\{std\}",
        ptrue: "p_\{\\text\{true\}\}",
        R: "\\mathcal\{R\}",
        RD: "\\text\{RD\}",
        RR: "\\text\{RR\}",
        sens: "\\text\{sens\}",
        spec: "\\text\{spec\}",
        std: "\\text\{std\}",
        supp: ["\\operatorname\{supp\}"],
        tcens: "t^\\text\{cens\}",
        tentry: "t^\\text\{entry\}",
        tevent: "t^\\text\{event\}",
        texit: "t^\\text\{exit\}",
        Tminus: "\\text\{T\}^-",
        tonset: "t^\\text\{onset\}",
        Tplus: "\\text\{T\}^+",
        transpose: "\\mathsf{T}",
        trec: "t^\\text\{rec\}",
        true: "\\text\{true\}",
        twobytwo: "2 \\times 2",
        vand: "\\text\{ and \}",
        Var: ["\\operatorname\{Var\}"],
        Xminus: "\\text\{X\}^-",
        Xobs: "\\text\{X\}^\\text\{obs\}",
        Xplus: "\\text\{X\}^+"
      }
    }
  };
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stratification.html">Epidemologic and Statistical Methods for Causal Inference</a></li><li class="breadcrumb-item"><a href="./matching.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Matching in Cohort and Case-Control Studies</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analytical Epidemiology</a> 
        <div class="sidebar-tools-main">
    <a href="./Analytical-Epidemiology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Defining and Measuring Disease Occurrence</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability, Random Variables, and Disease Occurrence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./condprob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Conditional Probability and Diagnostic Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlestimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Maximum Likelihood Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Longitudinal Data, Rates, and Counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">One-Sample Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Study Design and Measures of Association</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./studydesign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Cohort and Case-Control Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Internal and External Validity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cohort.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Measures of Association in Cohort Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Two-Sample Survival Analysis and the Cox Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./casecontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design and Analysis of Case-Control and Case-Cohort studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bayesian analysis of cohort and case-control studies</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Principles of Causal Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Causality in Public Health</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./counterfactuals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Potential Outcomes and Attributable Risk</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Confounding and Selection Bias on DAGs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./swigs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Confounding and Selection Bias on SWIGs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./standardization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Causal Effects and Standardization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geometry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Geometry of Causal Inference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Epidemologic and Statistical Methods for Causal Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stratification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Stratified Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matching.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Matching in Cohort and Case-Control Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./outcomereg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multivariable outcome regression models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./propensityscores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">propensityscores.html</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./marginalstructural.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">marginalstructural.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Calculus</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#matching-in-a-cohort-study" id="toc-matching-in-a-cohort-study" class="nav-link active" data-scroll-target="#matching-in-a-cohort-study"><span class="header-section-number">20.0.1</span> Matching in a cohort study</a></li>
  <li><a href="#matching-on-non-confounders" id="toc-matching-on-non-confounders" class="nav-link" data-scroll-target="#matching-on-non-confounders"><span class="header-section-number">20.0.2</span> Matching on non-confounders</a></li>
  <li><a href="#matching-and-efficiency" id="toc-matching-and-efficiency" class="nav-link" data-scroll-target="#matching-and-efficiency"><span class="header-section-number">20.0.3</span> Matching and efficiency</a></li>
  <li><a href="#matching-in-a-case-control-study" id="toc-matching-in-a-case-control-study" class="nav-link" data-scroll-target="#matching-in-a-case-control-study"><span class="header-section-number">20.1</span> Matching in a case-control study</a>
  <ul class="collapse">
  <li><a href="#matching-on-non-confounders-1" id="toc-matching-on-non-confounders-1" class="nav-link" data-scroll-target="#matching-on-non-confounders-1"><span class="header-section-number">20.1.1</span> Matching on non-confounders</a></li>
  <li><a href="#matching-and-efficency" id="toc-matching-and-efficency" class="nav-link" data-scroll-target="#matching-and-efficency"><span class="header-section-number">20.1.2</span> Matching and efficency</a></li>
  </ul></li>
  <li><a href="#overmatching" id="toc-overmatching" class="nav-link" data-scroll-target="#overmatching"><span class="header-section-number">20.2</span> Overmatching</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stratification.html">Epidemologic and Statistical Methods for Causal Inference</a></li><li class="breadcrumb-item"><a href="./matching.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Matching in Cohort and Case-Control Studies</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Matching in Cohort and Case-Control Studies</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>For an observational study to compare two groups with respect to a dichotomous outcome variable, the design strategy of matching observational units with respect to a potential confounding variable X is compared with the strategy of selecting independent samples with possible poststratification on X for bias control. … It is found that proper understanding requires that the prospective and the retrospective study designs be separately considered, and that in certain circumstances the effect of matching on design efficiency is entirely different for the two designs. <span class="citation" data-cites="samuels1981matching">(<a href="references.html#ref-samuels1981matching" role="doc-biblioref">Samuels 1981</a>)</span></p>
</blockquote>
<p>When exchangeability (no confounding) and the analytic cohort condition (no selection bias) hold given a set of variables <span class="math inline">\(C\)</span>, then the conditional estimates of risk in the exposed and unexposed in the study sample are unbiased estimates of the causal risks of disease under exposure and no exposure in the eligible population. We have several ways to summarize the causal effect of exposure on disease:</p>
<ul>
<li><p>If there is no effect measure modification on the desired scale, we can use stratified analysis (e.g., Mantel-Haenszel) or a regression model to estimate a common conditional measure of association given <span class="math inline">\(C\)</span>.</p></li>
<li><p>If there is effect measure modification, we can estimate stratum-specific conditional measures of association given <span class="math inline">\(C\)</span>. This can be done nonparametrically or using a regression model with interaction terms for <span class="math inline">\(X\)</span> and <span class="math inline">\(C\)</span>.</p></li>
<li><p>Whether or not there is effect modification, we can use standardization to estimate marginal causal risks of disease. These marginal causal risks can be used to estimate marginal causal effects. If there is no effect measure modification and the measure is collapsible, the standardized measure of association will equal the common conditional measure of association given <span class="math inline">\(C\)</span>.</p></li>
</ul>
<p>If the case-control condition holds but not the cohort condition, then our only choice is to estimate conditional odds ratios given <span class="math inline">\(C\)</span>. Depending on the selection of controls, these can approximate conditional risk ratios or hazard ratios given <span class="math inline">\(C\)</span>.</p>
<p>Sometimes <span class="math inline">\(C\)</span> may consist of more than one variable. When we match on multiple covariates (e.g., age and biological sex), we match participants who have similar values for all of the matching variables. When <span class="math inline">\(C\)</span> has many levels, some strata may have no members from one of the two exposure groups. This can result in estimates that do not converge or have high variance.</p>
<p><strong>Matching</strong> can be used to ensure that we have individuals from both exposure or treatment groups in all levels of <span class="math inline">\(C\)</span>. When we match in a cohort study, we ensure that there is at least one individual from both treatment or exposure groups in each level of <span class="math inline">\(C\)</span>. When we match in a case-control study, we ensure that there is at least one case and one control from all levels of <span class="math inline">\(C\)</span>. It turns out that matching has different consequences in cohort and case-control studies:</p>
<ul>
<li><p>In a cohort study, matching is generally used to prevent confounding by ensuring that both exposure or treatment groups have the same distribution of <span class="math inline">\(C\)</span>. It is often not necessary to stratify or standardize by <span class="math inline">\(C\)</span>, except possibly to generalize to the eligible population.</p></li>
<li><p>In a case-control study, matching does not prevent confounding by <span class="math inline">\(C\)</span>. Instead, it is used to improve statistical efficiency in an analysis stratified by <span class="math inline">\(C\)</span>.</p></li>
</ul>
<p>Causal graphs can be used to understand these differences. In all cases, it is important to weigh the advantages and disadvantages of matching against those of analytical control for confounding through stratification or weighting.</p>
<section id="matching-in-a-cohort-study" class="level3" data-number="20.0.1">
<h3 data-number="20.0.1" class="anchored" data-anchor-id="matching-in-a-cohort-study"><span class="header-section-number">20.0.1</span> Matching in a cohort study</h3>
<p>In a matched cohort study, matching ensures that the exposure groups have the same distribution of <span class="math inline">\(C\)</span>. If exposure is less common than non-exposure, then we choose one or more non-exposed individuals from the same stratum of <span class="math inline">\(C\)</span> for each exposed individual. <a href="#fig-mcoh-swig" class="quarto-xref">Figure&nbsp;<span>20.1</span></a> shows a single-world intervention graph (SWIG) for a cohort study matched on a confounder <span class="math inline">\(C\)</span>. The cohort condition holds given <span class="math inline">\(C\)</span> because <span class="math inline">\(S^x \indep D^x \given X, C\)</span>.</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>matching-swig-coh.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># DAG for cohort study matched on a confounder</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># load R packages</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(ggdag, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># define the DAG</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>cohort <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag{</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="st">  C -&gt; D</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="st">  C -&gt; S</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="st">  C -&gt; X</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="st">  x -&gt; D</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="st">  x -&gt; S</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="st">}'</span>)</span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co"># generate data for plotting DAG using ggplot()</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co"># Use geom_dag_label() for adjusted variables to get a box around them.</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="fu">coordinates</span>(cohort) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="at">C =</span> <span class="dv">0</span>, <span class="at">X =</span> <span class="fl">0.9</span>, <span class="at">x =</span> <span class="fl">1.1</span>, <span class="at">S =</span> <span class="dv">2</span>, <span class="at">D =</span> <span class="dv">3</span>),</span>
<span id="cb1-20"><a href="#cb1-20"></a>                            <span class="at">y =</span> <span class="fu">c</span>(<span class="at">C =</span> <span class="dv">0</span>, <span class="at">X =</span> <span class="dv">0</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">S =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">D =</span> <span class="dv">0</span>))</span>
<span id="cb1-21"><a href="#cb1-21"></a>cohort_dat <span class="ot">&lt;-</span> <span class="fu">control_for</span>(cohort, <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"x"</span>), <span class="at">activate_colliders =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="fu">label</span>(cohort_dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C"</span> <span class="ot">=</span> <span class="st">"C"</span>, <span class="st">"X"</span> <span class="ot">=</span> <span class="st">"X"</span>, <span class="st">"x"</span> <span class="ot">=</span> <span class="st">"x"</span>,</span>
<span id="cb1-23"><a href="#cb1-23"></a>                       <span class="st">"D"</span> <span class="ot">=</span> <span class="st">"D^x"</span>, <span class="st">"S"</span> <span class="ot">=</span> <span class="st">"S^x"</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a>cohort_adj <span class="ot">&lt;-</span> <span class="fu">filter</span>(cohort_dat, adjusted <span class="sc">==</span> <span class="st">"adjusted"</span>)</span>
<span id="cb1-25"><a href="#cb1-25"></a>cohort_unadj <span class="ot">&lt;-</span> <span class="fu">filter</span>(cohort_dat, adjusted <span class="sc">==</span> <span class="st">"unadjusted"</span>)</span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co"># plot DAG with ggplot() to allow for boxes and curved arrows</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>(<span class="fu">ggplot</span>(cohort_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend))</span>
<span id="cb1-29"><a href="#cb1-29"></a>  <span class="sc">+</span> <span class="fu">theme_dag_gray_grid</span>()</span>
<span id="cb1-30"><a href="#cb1-30"></a>  <span class="sc">+</span> <span class="fu">coord_equal</span>()</span>
<span id="cb1-31"><a href="#cb1-31"></a>  <span class="sc">+</span> <span class="fu">geom_dag_label</span>(<span class="at">data =</span> cohort_adj, <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">fill =</span> <span class="cn">NA</span>,</span>
<span id="cb1-32"><a href="#cb1-32"></a>                   <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"lines"</span>))</span>
<span id="cb1-33"><a href="#cb1-33"></a>  <span class="sc">+</span> <span class="fu">geom_dag_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">data =</span> cohort_unadj, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-34"><a href="#cb1-34"></a>                  <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb1-35"><a href="#cb1-35"></a>  <span class="sc">+</span> <span class="fu">geom_dag_edges_arc</span>(<span class="at">curvature =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="sc">-</span><span class="fl">0.15</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb1-36"><a href="#cb1-36"></a>  <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.01</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">label =</span> <span class="st">"|"</span>)</span>
<span id="cb1-37"><a href="#cb1-37"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output-display">
<div id="fig-mcoh-swig" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mcoh-swig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="matching_files/figure-html/fig-mcoh-swig-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;20.1: SWIG for selection a cohort study matched on a confounder C. Exchangeability and the analytic cohort condition hold given C. Because of matching, both exposure groups have the same distribution of C."><img src="matching_files/figure-html/fig-mcoh-swig-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcoh-swig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.1: SWIG for selection a cohort study matched on a confounder <span class="math inline">\(C\)</span>. Exchangeability and the analytic cohort condition hold given <span class="math inline">\(C\)</span>. Because of matching, both exposure groups have the same distribution of <span class="math inline">\(C\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Matching ensures that the distribution of <span class="math inline">\(C\)</span> is the same in both exposure groups and in the study sample, so a crude measure of association based on disease risks is implicitly standardized to this distribution of <span class="math inline">\(C\)</span>. Therefore, adjustment for <span class="math inline">\(C\)</span> is not necessary to estimate the marginal causal effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(D\)</span> in the study sample (i.e., in a standard population with the same distribution of <span class="math inline">\(C\)</span> as the study sample). However, generalization to the eligible population (or to the exposed or unexposed groups in the eligible population) can require adjustment for <span class="math inline">\(C\)</span> if there is effect measure modification or noncollapsibility. If <span class="math inline">\(C\)</span> is conditionally independent of <span class="math inline">\(S\)</span> given <span class="math inline">\(X = 1\)</span>, then the distribution of <span class="math inline">\(C\)</span> in the study sample is the same as the distribution of <span class="math inline">\(C\)</span> among the exposed in the eligible population. In this, the marginal causal effect in the study sample is a consistent estimate of the marginal causal effect among the exposed in the eligible population.</p>
</section>
<section id="matching-on-non-confounders" class="level3" data-number="20.0.2">
<h3 data-number="20.0.2" class="anchored" data-anchor-id="matching-on-non-confounders"><span class="header-section-number">20.0.2</span> Matching on non-confounders</h3>
<p>If we remove the edge from <span class="math inline">\(C\)</span> to <span class="math inline">\(X\)</span> in <a href="#fig-mcoh-swig" class="quarto-xref">Figure&nbsp;<span>20.1</span></a>, then <span class="math inline">\(C\)</span> is associated with <span class="math inline">\(D\)</span> but not a confounder. Because of the path <span class="math inline">\(S^x \leftarrow C \rightarrow D^x\)</span>, we still need to condition on <span class="math inline">\(C\)</span> to prevent selection bias. However, this is necessary only because of the path <span class="math inline">\(C \rightarrow S^x\)</span> caused by matching. The result is the same as before: The causal effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(D\)</span> in a standard population with the same distribution of <span class="math inline">\(C\)</span> as the study sample can be estimated without adjustment for <span class="math inline">\(C\)</span>, but generalization to the eligible population requires adjustment for <span class="math inline">\(C\)</span> if there is effect modification or noncollapsibility.</p>
<p>If we remove the edge from <span class="math inline">\(C\)</span> to <span class="math inline">\(D\)</span> in Figure~<a href="#fig:mcohort" data-reference-type="ref" data-reference="fig:mcohort">[fig:mcohort]</a>, then <span class="math inline">\(C\)</span> is associated with <span class="math inline">\(X\)</span> but not a confounder. In this case, the cohort condition holds without conditioning on <span class="math inline">\(C\)</span>, so no adjustment for <span class="math inline">\(C\)</span> is necessary for estimation of marginal causal effects or generalization to the eligible population.</p>
</section>
<section id="matching-and-efficiency" class="level3" data-number="20.0.3">
<h3 data-number="20.0.3" class="anchored" data-anchor-id="matching-and-efficiency"><span class="header-section-number">20.0.3</span> Matching and efficiency</h3>
<p>In a clinical trial, <strong>blocking</strong> refers to assigning treatment within groups defined by baseline variables. In <em>pairwise blocking</em>, participants are grouped into pairs based on baseline variables and treatment is assigned to one person in each pair. Blocking usually improves the efficiency of a clinical trial when the blocks are defined by risk factors for disease.</p>
<p>By analogy to blocking in a clinical trial, it is often thought that matching will improve the efficiency of a cohort study. However, <span class="citation" data-cites="greenland1990matching">Greenland and Morgenstern (<a href="references.html#ref-greenland1990matching" role="doc-biblioref">1990</a>)</span> showed that this is not always the case. In particular, matching in a cohort study can change the distribution of <span class="math inline">\(C\)</span> in the study sample in a way that increases the variance of the effect estimate. By contrast, blocking never changes the distribution of <span class="math inline">\(C\)</span> in a clinical trial. The key difference is that blocking in a clinical trial is a method of treatment assignment while matching in an observational cohort study is a method of selecting study participants. Matching can increase or decrease efficiency in a cohort study, and it will almost alway make participant selection more difficult.</p>
</section>
<section id="matching-in-a-case-control-study" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="matching-in-a-case-control-study"><span class="header-section-number">20.1</span> Matching in a case-control study</h2>
<p><a href="#fig-mcc-swig" class="quarto-xref">Figure&nbsp;<span>20.2</span></a> shows a SWIG for a case-control study matched on a confounder <span class="math inline">\(C\)</span>. The cohort condition fails because <span class="math inline">\(S\)</span> is a child of <span class="math inline">\(D\)</span>, but the case-control condition holds given <span class="math inline">\(C\)</span> because <span class="math inline">\(S^d \indep X \given D, C\)</span>. It follows that our measure of association must be based on the prevalence of exposure in cases and controls and that we must control for <span class="math inline">\(C\)</span> to avoid selection bias.</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>matching-swig-cc.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># DAG for cohort study matched on a confounder</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># load R packages</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># define the DAG</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>casecontrol <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag{</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="st">  C -&gt; D</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="st">  C -&gt; S</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="st">  C -&gt; X</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="st">  d -&gt; S</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="st">  X -&gt; D</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="st">}'</span>)</span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co"># generate data for plotting DAG using ggplot()</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># Use geom_dag_label() for adjusted variables to get a box around them.</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="fu">coordinates</span>(casecontrol) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="at">C =</span> <span class="dv">0</span>, <span class="at">X =</span> <span class="fl">0.9</span>, <span class="at">D =</span> <span class="fl">1.9</span>, <span class="at">d =</span> <span class="fl">2.1</span>, <span class="at">S =</span> <span class="dv">3</span>),</span>
<span id="cb2-20"><a href="#cb2-20"></a>                                 <span class="at">y =</span> <span class="fu">c</span>(<span class="at">C =</span> <span class="dv">0</span>, <span class="at">X =</span> <span class="dv">0</span>, <span class="at">D =</span> <span class="dv">0</span>, <span class="at">d =</span> <span class="dv">0</span>, <span class="at">S =</span> <span class="sc">-</span><span class="fl">0.4</span>))</span>
<span id="cb2-21"><a href="#cb2-21"></a>cc_dat <span class="ot">&lt;-</span> <span class="fu">control_for</span>(casecontrol, <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"d"</span>), <span class="at">activate_colliders =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="fu">label</span>(cc_dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C"</span> <span class="ot">=</span> <span class="st">"C"</span>, <span class="st">"X"</span> <span class="ot">=</span> <span class="st">"X"</span>, <span class="st">"x"</span> <span class="ot">=</span> <span class="st">"x"</span>, <span class="st">"D"</span> <span class="ot">=</span> <span class="st">"D"</span>,</span>
<span id="cb2-23"><a href="#cb2-23"></a>                   <span class="st">"d"</span> <span class="ot">=</span> <span class="st">"d"</span>, <span class="st">"S"</span> <span class="ot">=</span> <span class="st">"S^d"</span>)</span>
<span id="cb2-24"><a href="#cb2-24"></a>cc_adj <span class="ot">&lt;-</span> <span class="fu">filter</span>(cc_dat, adjusted <span class="sc">==</span> <span class="st">"adjusted"</span>)</span>
<span id="cb2-25"><a href="#cb2-25"></a>cc_unadj <span class="ot">&lt;-</span> <span class="fu">filter</span>(cc_dat, adjusted <span class="sc">==</span> <span class="st">"unadjusted"</span>)</span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co"># plot DAG with ggplot() to allow for boxes and curved arrows</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>(<span class="fu">ggplot</span>(cc_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend))</span>
<span id="cb2-29"><a href="#cb2-29"></a>  <span class="sc">+</span> <span class="fu">theme_dag_gray_grid</span>()</span>
<span id="cb2-30"><a href="#cb2-30"></a>  <span class="sc">+</span> <span class="fu">coord_equal</span>()</span>
<span id="cb2-31"><a href="#cb2-31"></a>  <span class="sc">+</span> <span class="fu">geom_dag_label</span>(<span class="at">data =</span> cc_adj, <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">fill =</span> <span class="cn">NA</span>,</span>
<span id="cb2-32"><a href="#cb2-32"></a>                   <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"lines"</span>))</span>
<span id="cb2-33"><a href="#cb2-33"></a>  <span class="sc">+</span> <span class="fu">geom_dag_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> label), <span class="at">data =</span> cc_unadj, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-34"><a href="#cb2-34"></a>                  <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb2-35"><a href="#cb2-35"></a>  <span class="sc">+</span> <span class="fu">geom_dag_edges_arc</span>(<span class="at">curvature =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb2-36"><a href="#cb2-36"></a>  <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.01</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">label =</span> <span class="st">"|"</span>)</span>
<span id="cb2-37"><a href="#cb2-37"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output-display">
<div id="fig-mcc-swig" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mcc-swig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="matching_files/figure-html/fig-mcc-swig-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;20.2: SWIG for a case-control study matched on a confounder C. The analytic case-control condition holds given C. Because of matching, the case and control groups have the same distribution of C."><img src="matching_files/figure-html/fig-mcc-swig-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mcc-swig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.2: SWIG for a case-control study matched on a confounder <span class="math inline">\(C\)</span>. The analytic case-control condition holds given <span class="math inline">\(C\)</span>. Because of matching, the case and control groups have the same distribution of <span class="math inline">\(C\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In a case-control study, matching ensures that the distribution of <span class="math inline">\(C\)</span> is equal in the case and control groups, not in the exposure groups. Because the exposure groups have different distributions of <span class="math inline">\(C\)</span>, the crude odds ratio cannot be interpreted as a causal effect of exposure within the study sample. The <span class="math inline">\(C\)</span>-conditional odds ratios have a causal interpretation, and they are identical (up to random variation) in the study sample and the eligible population. Away from the null, the <span class="math inline">\(C\)</span>-conditional odds ratios in the eligible population differ from the <span class="math inline">\(C\)</span>-marginal odds ratio in the study sample even when there is no effect modification, so adjustment for <span class="math inline">\(C\)</span> is necessary.</p>
<section id="matching-on-non-confounders-1" class="level3" data-number="20.1.1">
<h3 data-number="20.1.1" class="anchored" data-anchor-id="matching-on-non-confounders-1"><span class="header-section-number">20.1.1</span> Matching on non-confounders</h3>
<p>If we remove the edge from <span class="math inline">\(C\)</span> to <span class="math inline">\(X\)</span> in <a href="#fig-mcc-swig" class="quarto-xref">Figure&nbsp;<span>20.2</span></a>, then <span class="math inline">\(C\)</span> is associated with <span class="math inline">\(D\)</span> but not a confounder. Thus, both the marginal odds ratio and conditional odds ratios given <span class="math inline">\(C\)</span> in the eligible population have causal interpretations. Conditioning on the collider at <span class="math inline">\(D\)</span> opens the path <span class="math inline">\(X \rightarrow D \leftarrow C \rightarrow S^d\)</span>, so the case-control condition holds only given <span class="math inline">\(C\)</span>. Away from the null, the marginal odds ratios and conditional odds ratios given <span class="math inline">\(C\)</span> in the eligible population differ even when there is no effect modification by <span class="math inline">\(C\)</span>. When there is no effect modification, the conditional odds ratio given <span class="math inline">\(C\)</span> in the eligible population matches the marginal odds ratio in the study sample. Thus, matching on <span class="math inline">\(C\)</span> is harmful if the marginal odds ratio in the eligible population is of primary interest. Under the null, the case-control condition holds without conditioning on <span class="math inline">\(C\)</span> so no adjustment for <span class="math inline">\(C\)</span> is necessary.</p>
<p>If we remove the edge from <span class="math inline">\(C\)</span> to <span class="math inline">\(D\)</span> in <a href="#fig-mcc-swig" class="quarto-xref">Figure&nbsp;<span>20.2</span></a>, then <span class="math inline">\(C\)</span> is associated with <span class="math inline">\(X\)</span> but not a confounder. However, the case-control condition holds only given <span class="math inline">\(C\)</span> because of the path <span class="math inline">\(X \leftarrow C \rightarrow S^d\)</span>. When there is no effect modification by <span class="math inline">\(C\)</span>, the marginal odds ratio and conditional odds ratios given <span class="math inline">\(C\)</span> in the eligible population are equal. In the study sample, the marginal odds ratio and conditional odds ratio given <span class="math inline">\(C\)</span> differ away from the null even when there is no effect modification. Under the null, the marginal odds ratios are the same (up to random variation) in the study sample and the eligible population. Thus, adjustment for <span class="math inline">\(C\)</span> is necessary away from the null but not under the null.</p>
</section>
<section id="matching-and-efficency" class="level3" data-number="20.1.2">
<h3 data-number="20.1.2" class="anchored" data-anchor-id="matching-and-efficency"><span class="header-section-number">20.1.2</span> Matching and efficency</h3>
<p>In a case-control study, matching improves efficiency by ensuring that there is balance between cases and controls in the strata defined by <span class="math inline">\(C\)</span>. This can improve efficiency even when these strata are not sparse. Earlier, we saw that the power of a case-control study is maximized for a fixed total number of participants when we have equal numbers of cases and controls <span class="citation" data-cites="jewell2003statistics">(<a href="references.html#ref-jewell2003statistics" role="doc-biblioref">Jewell 2003</a>)</span>. Because controls are generally easier to find than cases of a rare disease, it is common to enroll 3–5 controls per case. Matching ensures that no strata of <span class="math inline">\(C\)</span> contain only cases, in which case they would be discarded in a Mantel-Haenszel estimate (and possibly in a GLM as well). Although matching on a confounder consistently improves the efficiency of case-control studies, its use must be balanced against the additional difficulty of finding controls and the availability of analytical methods such as stratification and weighting that can control for confounding.</p>
<p>Matching on a non-confounder necessitates a stratified analysis that can lead to a loss of statistical efficiency compared to a non-matched case control study with the same number of participants.</p>
</section>
</section>
<section id="overmatching" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="overmatching"><span class="header-section-number">20.2</span> Overmatching</h2>
<p>Matching can be useful, but it can also be harmful. Harmful matching is called <strong>overmatching</strong>, and it takes three forms <span class="citation" data-cites="rothman2008modern">(<a href="references.html#ref-rothman2008modern" role="doc-biblioref">Rothman, Greenland, and Lash 2008</a>)</span>: matching that reduces statistical efficiency, matching that induces bias, and matching that reduces cost efficiency.</p>
<ul>
<li><p>Statistical efficiency is about the precision of a causal effect estimate achieved with a given total number of participants. In a cohort study, matching prevents confounding but its effect on statistical efficiency can be difficult to predict. In a case-control study, it consistently improves statistical efficency for a given total number of participants, but it might harm overall efficiency if it leads to a lower total number of participants. It also necessitates a stratified analysis, which can reduce statistical efficiency if stratification by <span class="math inline">\(C\)</span> would not otherwise be needed.</p></li>
<li><p>Matching on a causal intermediate or a collider can cause bias just like stratifying on a causal intermediate or a collider. Matching should generally be done only on variables that are likely to be important confounders.</p></li>
<li><p>Cost efficiency is about the precision of a causal effect estimate achieved with a given total cost of a study. Some methods of recruiting controls lend themselves naturally to matching by neighborhood, family, friends etc. However, the potential for bias or loss of statistical efficiency should always be balanced against the convenience of control recruitment. It is also important to calibrate the closeness of the matching needed to control confounding. Requiring extremely close matches can greatly increase cost with little improvement in control for confounding or precision.</p></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-greenland1990matching" class="csl-entry" role="listitem">
Greenland, Sander, and Hal Morgenstern. 1990. <span>“Matching and Efficiency in Cohort Studies.”</span> <em>American Journal of Epidemiology</em> 131 (1): 151–59.
</div>
<div id="ref-jewell2003statistics" class="csl-entry" role="listitem">
Jewell, Nicholas P. 2003. <em>Statistics for Epidemiology</em>. CRC Press.
</div>
<div id="ref-rothman2008modern" class="csl-entry" role="listitem">
Rothman, Kenneth J, Sander Greenland, and Timothy L Lash. 2008. <em>Modern Epidemiology</em>. Lippincott Williams &amp; Wilkins.
</div>
<div id="ref-samuels1981matching" class="csl-entry" role="listitem">
Samuels, Myra L. 1981. <span>“Matching and Design Efficiency in Epidemiological Studies.”</span> <em>Biometrika</em> 68 (3): 577–88.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stratification.html" class="pagination-link" aria-label="Stratified Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Stratified Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./outcomereg.html" class="pagination-link" aria-label="Multivariable outcome regression models">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multivariable outcome regression models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>