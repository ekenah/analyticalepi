<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>12&nbsp; Bayesian analysis of cohort and case-control studies – Analytical Epidemiology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./causality.html" rel="next">
<link href="./casecontrol.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-747bc48f972f7c4036e4d8e8c6d9e55a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
  window.MathJax = {
    loader: {load: ['[tex]/centernot']},
    tex: {
      macros: {
        A: "\\mathcal\{A\}",
        approxsim: "\\stackrel\{\\text\{approx\}\}\{\\sim\}",
        AR: "\\text\{AR\}",
        B: "\\mathcal\{B\}",
        Bernoulli: ["\\operatorname\{Bernoulli\}"],
        binomial: ["\\operatorname\{binomial\}"],
        C: "\\mathcal\{C\}",
        chisqH: "\\chi^2_\\text\{H\}",
        chisqP: "\\chi^2_\\text\{P\}",
        chisqPobs: "\\chi^2_\\text\{Pobs\}",
        cHR: "\\text\{cHR\}",
        CHR: "\\text\{CHR\}",
        cloglog: ["\\operatorname\{cloglog\}"],
        comp: "\\mathsf\{C\}",
        Cov: ["\\operatorname\{Cov\}"],
        crude: "\\text\{crude\}",
        D: "\\mathcal\{D\}",
        data: "\\text\{data\}",
        dif: "\\text\{d\}",
        Dminus: "\\text\{D\}^-",
        Dplus: "\\text\{D\}^+",
        E: ["\\operatorname\{\\mathbb\{E\}\}"],
        ESSR: "\\text\{ESSR\}",
        expit: ["\\operatorname\{expit\}"],
        given: ["\\, #1| \\, ", 1],
        HR: "\\text\{HR\}",
        indep: "\\perp\\!\\!\\!\\perp",
        indicator: "\\mathbb\{1\}",
        IRR: "\\text\{IRR\}",
        K: "\\mathcal\{K\}",
        logit: ["\\operatorname\{logit\}"],
        margins: "\\text\{margins\}",
        obs: "\\text\{obs\}",
        odds: ["\\operatorname\{odds\}"],
        OR: "\\text\{OR\}",
        pa: "\\text\{pa\}",
        PAR: "\\text\{PAR\}",
        pcrude: "p^*\_\\text\{crude\}",
        pmarg: "p\_\\text\{marg\}",
        Prstd: "\\Pr\\nolimits\_\\text\{std\}",
        ptrue: "p_\{\\text\{true\}\}",
        R: "\\mathcal\{R\}",
        RD: "\\text\{RD\}",
        RR: "\\text\{RR\}",
        sens: "\\text\{sens\}",
        spec: "\\text\{spec\}",
        std: "\\text\{std\}",
        supp: ["\\operatorname\{supp\}"],
        tcens: "t^\\text\{cens\}",
        tentry: "t^\\text\{entry\}",
        tevent: "t^\\text\{event\}",
        texit: "t^\\text\{exit\}",
        Tminus: "\\text\{T\}^-",
        tonset: "t^\\text\{onset\}",
        Tplus: "\\text\{T\}^+",
        transpose: "\\mathsf{T}",
        trec: "t^\\text\{rec\}",
        true: "\\text\{true\}",
        twobytwo: "2 \\times 2",
        vand: "\\text\{ and \}",
        Var: ["\\operatorname\{Var\}"],
        Xminus: "\\text\{X\}^-",
        Xobs: "\\text\{X\}^\\text\{obs\}",
        Xplus: "\\text\{X\}^+"
      }
    }
  };
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./studydesign.html">Study Design and Measures of Association</a></li><li class="breadcrumb-item"><a href="./bayes2.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bayesian analysis of cohort and case-control studies</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analytical Epidemiology</a> 
        <div class="sidebar-tools-main">
    <a href="./Analytical-Epidemiology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Defining and Measuring Disease Occurrence</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability, Random Variables, and Disease Occurrence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./condprob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Conditional Probability and Diagnostic Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlestimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Maximum Likelihood Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Longitudinal Data, Rates, and Counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">One-Sample Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Study Design and Measures of Association</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./studydesign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Cohort and Case-Control Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Internal and External Validity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cohort.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Measures of Association in Cohort Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Two-Sample Survival Analysis and the Cox Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./casecontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design and Analysis of Case-Control and Case-Cohort studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bayesian analysis of cohort and case-control studies</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Principles of Causal Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Causality in Public Health</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./counterfactuals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Potential Outcomes and Attributable Risk</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Confounding and Selection Bias on DAGs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./swigs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Confounding and Selection Bias on SWIGs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./standardization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Causal Effects and Standardization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geometry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Geometry of Causal Inference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Epidemologic and Statistical Methods for Causal Inference</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Calculus</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#prior-distributions" id="toc-prior-distributions" class="nav-link active" data-scroll-target="#prior-distributions"><span class="header-section-number">12.1</span> Prior distributions</a></li>
  <li><a href="#posterior-distributions" id="toc-posterior-distributions" class="nav-link" data-scroll-target="#posterior-distributions"><span class="header-section-number">12.2</span> Posterior distributions</a>
  <ul class="collapse">
  <li><a href="#markov-chain-monte-carlo" id="toc-markov-chain-monte-carlo" class="nav-link" data-scroll-target="#markov-chain-monte-carlo"><span class="header-section-number">12.2.1</span> Markov chain Monte Carlo</a></li>
  <li><a href="#hamiltonian-monte-carlo" id="toc-hamiltonian-monte-carlo" class="nav-link" data-scroll-target="#hamiltonian-monte-carlo"><span class="header-section-number">12.2.2</span> Hamiltonian Monte Carlo</a></li>
  <li><a href="#laplace-approximation" id="toc-laplace-approximation" class="nav-link" data-scroll-target="#laplace-approximation"><span class="header-section-number">12.2.3</span> Laplace approximation</a></li>
  <li><a href="#inference-with-samples-from-the-posterior" id="toc-inference-with-samples-from-the-posterior" class="nav-link" data-scroll-target="#inference-with-samples-from-the-posterior"><span class="header-section-number">12.2.4</span> Inference with samples from the posterior</a></li>
  </ul></li>
  <li><a href="#cohort-studies" id="toc-cohort-studies" class="nav-link" data-scroll-target="#cohort-studies"><span class="header-section-number">12.3</span> Cohort studies</a>
  <ul class="collapse">
  <li><a href="#risk-ratios" id="toc-risk-ratios" class="nav-link" data-scroll-target="#risk-ratios"><span class="header-section-number">12.3.1</span> Risk ratios</a></li>
  <li><a href="#odds-ratios" id="toc-odds-ratios" class="nav-link" data-scroll-target="#odds-ratios"><span class="header-section-number">12.3.2</span> Odds ratios</a></li>
  <li><a href="#accelerated-failure-time-models" id="toc-accelerated-failure-time-models" class="nav-link" data-scroll-target="#accelerated-failure-time-models"><span class="header-section-number">12.3.3</span> Accelerated failure time models</a></li>
  <li><a href="#proportional-hazards-models" id="toc-proportional-hazards-models" class="nav-link" data-scroll-target="#proportional-hazards-models"><span class="header-section-number">12.3.4</span> Proportional hazards models</a></li>
  </ul></li>
  <li><a href="#case-control-studies" id="toc-case-control-studies" class="nav-link" data-scroll-target="#case-control-studies"><span class="header-section-number">12.4</span> Case-control studies</a>
  <ul class="collapse">
  <li><a href="#conditional-logistic-regression" id="toc-conditional-logistic-regression" class="nav-link" data-scroll-target="#conditional-logistic-regression"><span class="header-section-number">12.4.1</span> Conditional logistic regression</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./studydesign.html">Study Design and Measures of Association</a></li><li class="breadcrumb-item"><a href="./bayes2.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bayesian analysis of cohort and case-control studies</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-Bayes2" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bayesian analysis of cohort and case-control studies</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Probability logic also provides a basis for recognizing prior distributions as an integral component of statistical analysis, rather than the current misleading practice of pretending that statistics applied to observational data are objective. This basis is important, because the use of realistic priors in a statistical analysis can yield more stringent tests of hypotheses and more accurate estimates than conventional procedures. <span class="citation" data-cites="greenland1998probability">(<a href="references.html#ref-greenland1998probability" role="doc-biblioref">Greenland 1998</a>)</span></p>
</blockquote>
<p>When we considered the Bayesian estimation of risks and rates in <a href="bayes.html" class="quarto-xref"><span>Chapter 4</span></a>, we used the beta conjugate distribution for binomial models for risks and the gamma conjugate distribution for exponential or Poisson models for rates. When we are comparing two samples in a cohort or case-control study, there are no simple conjugate distributions for parameters. Instead, there are algorithms for sampling from the posterior distribution, and inferences are based on these samples.</p>
<section id="prior-distributions" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="prior-distributions"><span class="header-section-number">12.1</span> Prior distributions</h2>
<p>A noninformative prior is meant to “let the data speak for itself”, but this generally comes at the price of ignoring existing knowledge about the exposure, the outcome, and the population. With a large sample, Bayesian analysis with noninformative priors produces results similar to maximum likelihood. However, Bayesian methods do not rely on the central limit theorem, so they adapt more easily to small sample sizes.</p>
<p>Although prior distributions are often viewed with suspicion, they are an important advantage of the Bayesian approach to statistical inference. The flat priors implicit in frequentist methods do not imply objectivity. Using a prior distribution that incorporates background knowledge will produce more precise and accurate parameter estimates and predictions than an analysis using noninformative priors.</p>
</section>
<section id="posterior-distributions" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="posterior-distributions"><span class="header-section-number">12.2</span> Posterior distributions</h2>
<p>Without conjugate distributions, deriving the joint posterior distribution for model parameters can be much more difficult. The most common approach is to take samples from the posterior distribution and use these samples to get point and interval estimates of parameters or functions of parameters. Sampling from the posterior is complicated by the fact that we only know the posterior up to a constant of proportionality. If <span class="math inline">\(\pi(\theta)\)</span> is the prior distribution and <span class="math inline">\(L(\theta)\)</span> is the likelihood for our data, then <span id="eq-posterior"><span class="math display">\[
  \pi(\theta \given{} \data)
  = \frac{L(\theta) \pi(\theta)}{\pi(\data)}
  \propto L(\theta) \pi(\theta)
\tag{12.1}\]</span></span> where <span class="math inline">\(\pi(data)\)</span> is the marginal probability of the data, which is generally difficult or impossible to calculate.</p>
<section id="markov-chain-monte-carlo" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="markov-chain-monte-carlo"><span class="header-section-number">12.2.1</span> Markov chain Monte Carlo</h3>
<p>In <strong>Markov chain Monte Carlo</strong> (MCMC), we generate a random walk across the set of possible <span class="math inline">\(\theta\)</span> so that the distribution of points we visit converges to the posterior distribution <span class="citation" data-cites="gelman2013bayesian">(<a href="references.html#ref-gelman2013bayesian" role="doc-biblioref">Gelman et al. 2014</a>)</span>. We choose a starting point <span class="math inline">\(\theta_0\)</span>. At each <span class="math inline">\(\theta_k\)</span>, we propose a <span class="math inline">\(\theta^*\)</span> from a <em>proposal distribution</em> or <em>jumping distribution</em> <span class="math inline">\(J(\theta^* \given{} \theta_k)\)</span>. In the <strong>Metropolis algorithm</strong> <span class="citation" data-cites="metropolis1953equation">(<a href="references.html#ref-metropolis1953equation" role="doc-biblioref">Metropolis et al. 1953</a>)</span>, the proposal distribution is symmetric in the sense that <span class="math display">\[
  J(\theta^* \given{} \theta_k)
  = J(\theta_k \given{} \theta^*)
\]</span> for any <span class="math inline">\(\theta^*\)</span> and <span class="math inline">\(\theta_k\)</span>. We then choose whether to stay at the same place (i.e., <span class="math inline">\(\theta_{k + 1} = \theta_k\)</span>) or to jump to <span class="math inline">\(\theta^*\)</span> (i.e., <span class="math inline">\(\theta_{k + 1} = \theta_*\)</span>). The distribution of points we visit will converge the posterior distribution of <span class="math inline">\(\theta\)</span> if <span class="math display">\[
  \pi(\theta_k \given{} \data) \Pr(\text{jump from } \theta_k \text{ to } \theta^*)
  = \pi(\theta^* \given{} \data) \Pr(\text{jump from } \theta^* \text{ to } \theta^k)
\]</span> so that jumps from <span class="math inline">\(\theta_k\)</span> to <span class="math inline">\(\theta^*\)</span> happen as often as the reverse jumps from <span class="math inline">\(\theta^*\)</span> to <span class="math inline">\(\theta_k\)</span>. This is called the <em>detailed balance condition</em>, and the jump probabilities can be replaced with probability densities when the space of possible <span class="math inline">\(\theta\)</span> is continuous.</p>
<p>Rearranging the detailed balance condition, we get <span class="math display">\[
  \Pr(\text{jump from } \theta_k \text{ to } \theta^*)
  = \frac{\pi(\theta^* \given{} \data)}{\pi(\theta_k \given{} \data)}
    \Pr(\text{jump from } \theta^* \text{ to } \theta_k).
\]</span> If we always jump from <span class="math inline">\(\theta^*\)</span> to <span class="math inline">\(\theta_k\)</span> when <span class="math inline">\(\pi(\theta^* \given{} \data) &lt; \pi(\theta_k \given{} \data)\)</span>, then the probability of jumping from <span class="math inline">\(\theta_k\)</span> to <span class="math inline">\(\theta^*\)</span> must be <span class="math display">\[
  r = \frac{\pi(\theta^* \given{} \data)}{\pi(\theta_k \given{} \data)}
  = \frac{L(\theta^*) \pi(\theta^*)}{L(\theta_k) \pi(\theta_k)},
\]</span> where the unknown <span class="math inline">\(\pi(\data)\)</span> from <a href="#eq-posterior" class="quarto-xref">Equation&nbsp;<span>12.1</span></a> has canceled out. Therefore, we will meet the detailed balance condition if <span class="math display">\[
  \theta_{k + 1} =
  \begin{cases}
    \theta^*  &amp;\text{ with probability} \min(r, 1), \\
    \theta_k  &amp;\text{otherwise}.
  \end{cases}
\]</span> This is not the only rule that will lead to the detailed balance condition, but it is the one used by the Metropolis algorithm.</p>
<p>The <strong>Metropolis-Hastings algorithm</strong> <span class="citation" data-cites="hastings1970monte">(<a href="references.html#ref-hastings1970monte" role="doc-biblioref">Hastings 1970</a>)</span> allows the proposal distribution to be asymmetric. In that case, the procedure is the same except that <span class="math display">\[
  r = \frac{\pi(\theta^* \given{} \data) / J(\theta^* \given{} \theta_k)}
    {\pi(\theta_k \given{} \data) / J(\theta_k \given{} \theta^*)}.
\]</span> This allows much greater flexibility in proposal distributions. A good proposal distribution should be easy to sample from, make it easy to calculate <span class="math inline">\(r\)</span>, propose jumps that are not too big and not too small <span class="citation" data-cites="gelman2013bayesian">(<a href="references.html#ref-gelman2013bayesian" role="doc-biblioref">Gelman et al. 2014</a>)</span>. If the proposed jumps are too small, the space of possible <span class="math inline">\(\theta\)</span> will not be explored effectively by the MCMC random walk even if we accept most jumps. If the proposed jumps are too large, the proposed <span class="math inline">\(\theta^*\)</span> will be rejected too often and the MCMC random walk will get stuck.</p>
<p>The initial samples in an MCMC have a distribution that has not yet converged to the posterior distribution of <span class="math inline">\(\theta\)</span>. This period is called <strong>burn-in</strong> or <strong>warm-up</strong>, and early samples are generally discarded. Even after burn-in, the samples produced by an MCMC can be highly correlated, so the effective sample size is much less than the actual number of samples. This correlation can be reduced by <strong>thinning</strong> the chain by keeping, for example, every 10th sample. To monitor convergence, it is common to start several chains in different places and calculate the variation within chains and between chains for each component of <span class="math inline">\(\theta\)</span>. When convergence is reached, the variation within chains is similar to the variation between chains.</p>
</section>
<section id="hamiltonian-monte-carlo" class="level3" data-number="12.2.2">
<h3 data-number="12.2.2" class="anchored" data-anchor-id="hamiltonian-monte-carlo"><span class="header-section-number">12.2.2</span> Hamiltonian Monte Carlo</h3>
<p><strong>Hamiltonian Monte Carlo</strong> (HMC) adapts methods from physics to tune the proposed jumps in an MCMC <span class="citation" data-cites="duane1987hybrid neal1996monte">(<a href="references.html#ref-duane1987hybrid" role="doc-biblioref">Duane et al. 1987</a>; <a href="references.html#ref-neal1996monte" role="doc-biblioref">Neal 1996</a>)</span>, allowing the random walk to explore the posterior distribution more efficiently. HMC treats <span class="math inline">\(\theta\)</span> as a position and adds a momentum variable <span class="math inline">\(\phi\)</span> that has the same dimension (i.e., number of components) as <span class="math inline">\(\theta\)</span>. Starting from <span class="math inline">\((\theta_k, \phi_k)\)</span>, both <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\phi\)</span> are updated multiple times in <em>leapfrog steps</em> to generate a proposal <span class="math inline">\((\theta^*, \phi^*)\)</span>. At the end of the leapfrog steps, a Metropolis-Hastings step decides whether to stay at <span class="math inline">\((\theta_k, \phi_k)\)</span> or jump to <span class="math inline">\((\theta^*, \phi^*)\)</span>. Usually, these steps are rejected with much lower probability than the proposed jumps in an MCMC.</p>
<p>The momentum is used to nudge <span class="math inline">\(\theta\)</span> toward values of <span class="math inline">\(\theta\)</span> with higher posterior density. If <span class="math inline">\(\theta\)</span> takes a path with decreasing posterior density, its momentum <span class="math inline">\(\phi\)</span> starts to decrease and eventually point in the opposite direction, pulling <span class="math inline">\(\theta\)</span> back toward a region with higher posterior density. If <span class="math inline">\(\theta\)</span> takes a path with increasing posterior density, its momentum <span class="math inline">\(\phi\)</span> will increase in that direction until it crosses a peak and the posterior density starts to decrease again <span class="citation" data-cites="gelman2013bayesian">(<a href="references.html#ref-gelman2013bayesian" role="doc-biblioref">Gelman et al. 2014</a>)</span>. The size of the jumps acts like kinetic energy, and <span class="math inline">\(-\ln \pi(\theta \given{} \data)\)</span> acts like the potential energy. The random walk is attracted to regions of low potential energy (i.e., high posterior density) like a marble rolling around a bowl, but the conservation of energy ensures that the marble does not get stuck at the bottom.</p>
</section>
<section id="laplace-approximation" class="level3" data-number="12.2.3">
<h3 data-number="12.2.3" class="anchored" data-anchor-id="laplace-approximation"><span class="header-section-number">12.2.3</span> Laplace approximation</h3>
</section>
<section id="inference-with-samples-from-the-posterior" class="level3" data-number="12.2.4">
<h3 data-number="12.2.4" class="anchored" data-anchor-id="inference-with-samples-from-the-posterior"><span class="header-section-number">12.2.4</span> Inference with samples from the posterior</h3>
</section>
</section>
<section id="cohort-studies" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="cohort-studies"><span class="header-section-number">12.3</span> Cohort studies</h2>
<section id="risk-ratios" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="risk-ratios"><span class="header-section-number">12.3.1</span> Risk ratios</h3>
<p>Main messages:</p>
<ul>
<li><p>Specifying an informative prior based on background knowledge can improve precision.</p></li>
<li><p>Samples from the posterior can be used for inference about parameters and functions of parameters.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>riskratio-Bayes.R</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename="riskratio-Bayes.R"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="do">## Bayesian estimation of risk ratios</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># load packages</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># The rats data is from:</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># Mantel, Bohidar, and Ciminera (1977). Cancer Research 37: 3863-3868.</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(rstanarm)               <span class="co"># Bayesian regression models</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(survival)               <span class="co"># rats data</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># GLMs in rstanarm are "stanreg" objects</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>? stan_glm</span>
<span id="cb1-11"><a href="#cb1-11"></a>? coef.stanreg</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># binomial GLM with log link (log-binomial model) for the RR</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>RRglm <span class="ot">&lt;-</span> <span class="fu">glm</span>(status <span class="sc">~</span> rx, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> rats)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">exp</span>(<span class="fu">coef</span>(RRglm))                <span class="co"># estimated risk (x = 0) and RR</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">exp</span>(<span class="fu">confint</span>(RRglm))             <span class="co"># likelihood ratio CIs</span></span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co"># Bayesian GLM with log link fit using a flat prior for coefficients</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co"># Use "prior = NULL" to specify a flat prior.</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co"># Samples four chains with 2000 iteractions each by default.</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co"># In each chain, the first 1000 samples are warmup and the last 1000 are kept.</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>RRbayes_non <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(status <span class="sc">~</span> rx, <span class="at">data =</span> rats,</span>
<span id="cb1-23"><a href="#cb1-23"></a>                        <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">prior =</span> <span class="cn">NULL</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="fu">prior_summary</span>(RRbayes_non)      <span class="co"># summary of prior distributions</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="fu">summary</span>(RRbayes_non)            <span class="co"># summary of model fit (look for Rhat = 1)</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="fu">coef</span>(RRbayes_non)               <span class="co"># posterior medians (linear predictor scale)</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="fu">posterior_interval</span>(RRbayes_non) <span class="co"># 90% credible intervals (default)</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="fu">posterior_interval</span>(RRbayes_non, <span class="at">prob =</span> <span class="fl">0.95</span>)      <span class="co"># 95% credible intervals</span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="fu">exp</span>(<span class="fu">coef</span>(RRbayes_non))          <span class="co"># posterior medians for risk (rx = 0) and RR</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="fu">exp</span>(<span class="fu">posterior_interval</span>(RRbayes_non, <span class="at">prob =</span> <span class="fl">0.95</span>)) <span class="co"># 95% credible intervals</span></span>
<span id="cb1-31"><a href="#cb1-31"></a></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="co"># data frame of samples from the posterior distribution</span></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="co"># This allows you to calculate posterior means and functions of coefficients.</span></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="co"># Use double quotes for variable names with non-letters, like (Intercept).</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>post_non <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RRbayes_non)</span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="fu">median</span>(post_non<span class="sc">$</span><span class="st">"(Intercept)"</span>)  <span class="co"># equals intercept from coef()</span></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="fu">median</span>(post_non<span class="sc">$</span>rx)             <span class="co"># equals rx coefficient from coef()</span></span>
<span id="cb1-38"><a href="#cb1-38"></a><span class="fu">mean</span>(post_non<span class="sc">$</span>rx)               <span class="co"># posterior mean log RR</span></span>
<span id="cb1-39"><a href="#cb1-39"></a><span class="fu">quantile</span>(post_non<span class="sc">$</span>rx, <span class="fl">0.025</span>)    <span class="co"># lower 95% credible interval for log RR</span></span>
<span id="cb1-40"><a href="#cb1-40"></a><span class="fu">quantile</span>(post_non<span class="sc">$</span>rx, <span class="fl">0.975</span>)    <span class="co"># upper 95% credible interval for log RR</span></span>
<span id="cb1-41"><a href="#cb1-41"></a><span class="fu">quantile</span>(post_non<span class="sc">$</span>rx, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb1-42"><a href="#cb1-42"></a></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="co"># point estimates and credible intervals for risk in the treated</span></span>
<span id="cb1-44"><a href="#cb1-44"></a>post_non<span class="sc">$</span>lnrisk1 <span class="ot">&lt;-</span> post_non<span class="sc">$</span><span class="st">"(Intercept)"</span> <span class="sc">+</span> post_non<span class="sc">$</span>rx</span>
<span id="cb1-45"><a href="#cb1-45"></a>post_non<span class="sc">$</span>risk1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(post_non<span class="sc">$</span>lnrisk1)</span>
<span id="cb1-46"><a href="#cb1-46"></a><span class="fu">median</span>(post_non<span class="sc">$</span>lnrisk1)        <span class="co"># posterior median log risk in treated rats</span></span>
<span id="cb1-47"><a href="#cb1-47"></a><span class="fu">median</span>(post_non<span class="sc">$</span>risk1)          <span class="co"># posterior median risk in treated rats</span></span>
<span id="cb1-48"><a href="#cb1-48"></a><span class="fu">quantile</span>(post_non<span class="sc">$</span>risk1, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)) <span class="co"># 95% credible interval for risk</span></span>
<span id="cb1-49"><a href="#cb1-49"></a></span>
<span id="cb1-50"><a href="#cb1-50"></a><span class="co"># histogram of samples from posterior distribution of log(risk0)</span></span>
<span id="cb1-51"><a href="#cb1-51"></a><span class="co"># Use freq = FALSE to get probability densities instead of counts</span></span>
<span id="cb1-52"><a href="#cb1-52"></a>post_non<span class="sc">$</span>lnrisk0 <span class="ot">&lt;-</span> post_non<span class="sc">$</span><span class="st">"(Intercept)"</span>      <span class="co"># rename for convenience</span></span>
<span id="cb1-53"><a href="#cb1-53"></a><span class="fu">summary</span>(post_non<span class="sc">$</span>lnrisk0)</span>
<span id="cb1-54"><a href="#cb1-54"></a>post_non<span class="sc">$</span>risk0 <span class="ot">&lt;-</span> <span class="fu">exp</span>(post_non<span class="sc">$</span>lnrisk0)</span>
<span id="cb1-55"><a href="#cb1-55"></a><span class="fu">hist</span>(post_non<span class="sc">$</span>lnrisk0, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">"Log risk in untreated rats"</span>)</span>
<span id="cb1-56"><a href="#cb1-56"></a><span class="fu">grid</span>()</span>
<span id="cb1-57"><a href="#cb1-57"></a><span class="co"># add kernel density estimate</span></span>
<span id="cb1-58"><a href="#cb1-58"></a><span class="fu">lines</span>(<span class="fu">density</span>(post_non<span class="sc">$</span>lnrisk0), <span class="at">lty =</span> <span class="st">"dashed"</span>)</span>
<span id="cb1-59"><a href="#cb1-59"></a><span class="co"># add approximate normal distribution of MLE</span></span>
<span id="cb1-60"><a href="#cb1-60"></a>lnp0 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb1-61"><a href="#cb1-61"></a><span class="fu">lines</span>(lnp0, <span class="fu">dnorm</span>(lnp0, <span class="at">mean =</span> <span class="fu">coef</span>(RRglm)[<span class="dv">1</span>], <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fu">vcov</span>(RRglm)[<span class="dv">1</span>, <span class="dv">1</span>])))</span>
<span id="cb1-62"><a href="#cb1-62"></a></span>
<span id="cb1-63"><a href="#cb1-63"></a><span class="co"># plot of empirical CDF and normal CDF for MLE of risk in untreated rats</span></span>
<span id="cb1-64"><a href="#cb1-64"></a><span class="co"># For transformations, comparing CDFs does not require the delta method.</span></span>
<span id="cb1-65"><a href="#cb1-65"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(post_non<span class="sc">$</span>risk0), <span class="at">main =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-66"><a href="#cb1-66"></a>     <span class="at">xlab =</span> <span class="st">"Risk in untreated rats"</span>,</span>
<span id="cb1-67"><a href="#cb1-67"></a>     <span class="at">ylab =</span> <span class="st">"Cumulative distribution function"</span>)</span>
<span id="cb1-68"><a href="#cb1-68"></a><span class="fu">lines</span>(<span class="fu">exp</span>(lnp0), <span class="fu">pnorm</span>(lnp0, <span class="at">mean =</span> <span class="fu">coef</span>(RRglm)[<span class="dv">1</span>],</span>
<span id="cb1-69"><a href="#cb1-69"></a>                       <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fu">vcov</span>(RRglm)[<span class="dv">1</span>, <span class="dv">1</span>])),</span>
<span id="cb1-70"><a href="#cb1-70"></a>      <span class="at">lty =</span> <span class="st">"dashed"</span>)</span>
<span id="cb1-71"><a href="#cb1-71"></a><span class="fu">grid</span>()</span>
<span id="cb1-72"><a href="#cb1-72"></a></span>
<span id="cb1-73"><a href="#cb1-73"></a><span class="co"># histogram of samples from posterior distribution of log(risk ratio)</span></span>
<span id="cb1-74"><a href="#cb1-74"></a><span class="fu">summary</span>(post_non<span class="sc">$</span>rx)</span>
<span id="cb1-75"><a href="#cb1-75"></a><span class="fu">hist</span>(post_non<span class="sc">$</span>rx, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.4</span>),</span>
<span id="cb1-76"><a href="#cb1-76"></a>     <span class="at">xlab =</span> <span class="st">"Log risk ratio (treated / untreated)"</span>)</span>
<span id="cb1-77"><a href="#cb1-77"></a><span class="fu">grid</span>()</span>
<span id="cb1-78"><a href="#cb1-78"></a>lnrr <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">1.7</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb1-79"><a href="#cb1-79"></a><span class="fu">lines</span>(<span class="fu">density</span>(post_non<span class="sc">$</span>rx), <span class="at">lty =</span> <span class="st">"dashed"</span>)</span>
<span id="cb1-80"><a href="#cb1-80"></a><span class="fu">lines</span>(lnrr, <span class="fu">dnorm</span>(lnrr, <span class="fu">coef</span>(RRglm)[<span class="dv">2</span>], <span class="fu">sqrt</span>(<span class="fu">vcov</span>(RRglm)[<span class="dv">2</span>, <span class="dv">2</span>])))</span>
<span id="cb1-81"><a href="#cb1-81"></a></span>
<span id="cb1-82"><a href="#cb1-82"></a><span class="co"># plot of empirical CDF and normal CDF for MLE of risk ratio</span></span>
<span id="cb1-83"><a href="#cb1-83"></a><span class="co"># For transformations, comparing CDFs does not require the delta method.</span></span>
<span id="cb1-84"><a href="#cb1-84"></a>post_non<span class="sc">$</span>rr <span class="ot">&lt;-</span> <span class="fu">exp</span>(post_non<span class="sc">$</span>rx)</span>
<span id="cb1-85"><a href="#cb1-85"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(post_non<span class="sc">$</span>rr), <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>,</span>
<span id="cb1-86"><a href="#cb1-86"></a>     <span class="at">xlab =</span> <span class="st">"Risk ratio (treated / untreated)"</span>,</span>
<span id="cb1-87"><a href="#cb1-87"></a>     <span class="at">ylab =</span> <span class="st">"Cumulative distribution function"</span>)</span>
<span id="cb1-88"><a href="#cb1-88"></a><span class="fu">lines</span>(<span class="fu">exp</span>(lnrr), <span class="fu">pnorm</span>(lnrr, <span class="at">mean =</span> <span class="fu">coef</span>(RRglm)[<span class="dv">2</span>],</span>
<span id="cb1-89"><a href="#cb1-89"></a>                       <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fu">vcov</span>(RRglm)[<span class="dv">2</span>, <span class="dv">2</span>])),</span>
<span id="cb1-90"><a href="#cb1-90"></a>      <span class="at">lty =</span> <span class="st">"dashed"</span>)</span>
<span id="cb1-91"><a href="#cb1-91"></a><span class="fu">grid</span>()</span>
<span id="cb1-92"><a href="#cb1-92"></a></span>
<span id="cb1-93"><a href="#cb1-93"></a><span class="co"># using the default prior (weakly informative normal distributions)</span></span>
<span id="cb1-94"><a href="#cb1-94"></a><span class="co"># You can use the chains and iter arguments to change the sampling.</span></span>
<span id="cb1-95"><a href="#cb1-95"></a><span class="co"># The first half of each chain is warmup, and the last half is kept as samples.</span></span>
<span id="cb1-96"><a href="#cb1-96"></a>RRbayes_def <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(status <span class="sc">~</span> rx, <span class="at">data =</span> rats, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb1-97"><a href="#cb1-97"></a>                        <span class="at">iter =</span> <span class="dv">1500</span>, <span class="at">chains =</span> <span class="dv">6</span>)</span>
<span id="cb1-98"><a href="#cb1-98"></a><span class="fu">prior_summary</span>(RRbayes_def)</span>
<span id="cb1-99"><a href="#cb1-99"></a><span class="fu">summary</span>(RRbayes_def)</span>
<span id="cb1-100"><a href="#cb1-100"></a><span class="fu">exp</span>(<span class="fu">coef</span>(RRbayes_def))          <span class="co"># posterior medians for risk (rx = 0) and RR</span></span>
<span id="cb1-101"><a href="#cb1-101"></a><span class="fu">exp</span>(<span class="fu">posterior_interval</span>(RRbayes_def, <span class="at">prob =</span> <span class="fl">0.95</span>)) <span class="co"># 95% credible intervals</span></span>
<span id="cb1-102"><a href="#cb1-102"></a>post_def <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RRbayes_def)</span>
<span id="cb1-103"><a href="#cb1-103"></a></span>
<span id="cb1-104"><a href="#cb1-104"></a><span class="co"># compare distributions of RR under noninformative and default priors</span></span>
<span id="cb1-105"><a href="#cb1-105"></a>post_def<span class="sc">$</span>rr <span class="ot">&lt;-</span> <span class="fu">exp</span>(post_def<span class="sc">$</span>rx)</span>
<span id="cb1-106"><a href="#cb1-106"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(post_def<span class="sc">$</span>rr), <span class="at">main =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-107"><a href="#cb1-107"></a>     <span class="at">xlab =</span> <span class="st">"Risk ratio (treated / untreated)"</span>,</span>
<span id="cb1-108"><a href="#cb1-108"></a>     <span class="at">ylab =</span> <span class="st">"Cumulative distribution function"</span>)</span>
<span id="cb1-109"><a href="#cb1-109"></a><span class="fu">lines</span>(<span class="fu">ecdf</span>(post_non<span class="sc">$</span>rr), <span class="at">col =</span> <span class="st">"darkgray"</span>)</span>
<span id="cb1-110"><a href="#cb1-110"></a><span class="fu">grid</span>()</span>
<span id="cb1-111"><a href="#cb1-111"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">lty =</span> <span class="st">"solid"</span>,</span>
<span id="cb1-112"><a href="#cb1-112"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"darkgray"</span>),</span>
<span id="cb1-113"><a href="#cb1-113"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Weakly informative prior"</span>, <span class="st">"Noninformative prior"</span>))</span>
<span id="cb1-114"><a href="#cb1-114"></a></span>
<span id="cb1-115"><a href="#cb1-115"></a><span class="co"># specifying an informative prior</span></span>
<span id="cb1-116"><a href="#cb1-116"></a><span class="co"># For the intercept, we use normal with mean -ln(0.1) and sd = ln(1.5).</span></span>
<span id="cb1-117"><a href="#cb1-117"></a><span class="co"># For the coefficient on rx, we use a Laplace (double exponential).</span></span>
<span id="cb1-118"><a href="#cb1-118"></a>RRbayes <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(status <span class="sc">~</span> rx, <span class="at">data =</span> rats, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb1-119"><a href="#cb1-119"></a>                    <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="at">location =</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fl">0.2</span>),</span>
<span id="cb1-120"><a href="#cb1-120"></a>                                             <span class="at">scale =</span> <span class="fu">log</span>(<span class="dv">2</span>)),</span>
<span id="cb1-121"><a href="#cb1-121"></a>                    <span class="at">prior =</span> <span class="fu">normal</span>(<span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="fu">log</span>(<span class="dv">2</span>)))</span>
<span id="cb1-122"><a href="#cb1-122"></a><span class="fu">summary</span>(RRbayes)</span>
<span id="cb1-123"><a href="#cb1-123"></a><span class="fu">prior_summary</span>(RRbayes)</span>
<span id="cb1-124"><a href="#cb1-124"></a><span class="fu">exp</span>(<span class="fu">coef</span>(RRbayes))              <span class="co"># posterior medians for risk (rx = 0) and RR</span></span>
<span id="cb1-125"><a href="#cb1-125"></a><span class="fu">exp</span>(<span class="fu">posterior_interval</span>(RRbayes, <span class="at">prob =</span> <span class="fl">0.95</span>)) <span class="co"># 95% credible intervals</span></span>
<span id="cb1-126"><a href="#cb1-126"></a>post <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(RRbayes)</span>
<span id="cb1-127"><a href="#cb1-127"></a>post<span class="sc">$</span>lnrisk1 <span class="ot">&lt;-</span> post<span class="sc">$</span><span class="st">"(Intercept)"</span> <span class="sc">+</span> post<span class="sc">$</span>rx</span>
<span id="cb1-128"><a href="#cb1-128"></a>post<span class="sc">$</span>risk1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(post<span class="sc">$</span>lnrisk1)</span>
<span id="cb1-129"><a href="#cb1-129"></a><span class="fu">median</span>(post<span class="sc">$</span>risk1)              <span class="co"># posterior median risk in treated rats</span></span>
<span id="cb1-130"><a href="#cb1-130"></a><span class="fu">quantile</span>(post<span class="sc">$</span>risk1, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))   <span class="co"># 95% credible interval for risk</span></span>
<span id="cb1-131"><a href="#cb1-131"></a><span class="fu">quantile</span>(post<span class="sc">$</span>rx, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))      <span class="co"># compare to GLM 95% CI for rx coef</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="odds-ratios" class="level3" data-number="12.3.2">
<h3 data-number="12.3.2" class="anchored" data-anchor-id="odds-ratios"><span class="header-section-number">12.3.2</span> Odds ratios</h3>
<p>Main messages:</p>
<ul>
<li><p>The regression model does not dictate the measure of association. Here, we get risks and risk ratios out of a logistic regression model, which is specified in terms of odds and odds ratios.</p></li>
<li><p>Using samples from the posterior distribution is easier and more accurate than using the delta method.</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>oddsratio-Bayes.R</strong></pre>
</div>
<div class="sourceCode" id="cb2" data-filename="oddsratio-Bayes.R"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="do">## Bayesian estimation of odds ratios</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># load packages</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># The rats data is from:</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># Mantel, Bohidar, and Ciminera (1977). Cancer Research 37: 3863-3868.</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">library</span>(rstanarm)               <span class="co"># Bayesian regression models</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">library</span>(survival)               <span class="co"># rats data</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># GLMs in rstanarm are "stanreg" objects</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>? stan_glm</span>
<span id="cb2-11"><a href="#cb2-11"></a>? coef.stanreg</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># binomial GLM with log link (log-binomial model) for the RR</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>ORglm <span class="ot">&lt;-</span> <span class="fu">glm</span>(status <span class="sc">~</span> rx, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="at">data =</span> rats)</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="fu">exp</span>(<span class="fu">coef</span>(ORglm))                <span class="co"># estimated odds (x = 0) and OR</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="fu">exp</span>(<span class="fu">confint</span>(ORglm))             <span class="co"># likelihood ratio CIs</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># Bayesian GLM with identity link fit using a flat prior for coefficients</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co"># Use "prior = NULL" to specify a flat prior.</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co"># Samples four chains with 2000 iteractions each by default.</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co"># In each chain, the first 1000 samples are warmup and the last 1000 are kept.</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>ORbayes_non <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(status <span class="sc">~</span> rx, <span class="at">data =</span> rats,</span>
<span id="cb2-23"><a href="#cb2-23"></a>                        <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), <span class="at">prior =</span> <span class="cn">NULL</span>)</span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="fu">prior_summary</span>(ORbayes_non)      <span class="co"># summary of prior distributions</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="fu">summary</span>(ORbayes_non)            <span class="co"># summary of model fit (look for Rhat = 1)</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="fu">coef</span>(ORbayes_non)               <span class="co"># posterior medians (linear predictor scale)</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="fu">posterior_interval</span>(ORbayes_non) <span class="co"># 90% credible intervals (default)</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="fu">posterior_interval</span>(ORbayes_non, <span class="at">prob =</span> <span class="fl">0.95</span>)      <span class="co"># 95% credible intervals</span></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="fu">exp</span>(<span class="fu">coef</span>(ORbayes_non))          <span class="co"># posterior medians for odds (rx = 0) and OR</span></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="fu">exp</span>(<span class="fu">posterior_interval</span>(ORbayes_non, <span class="at">prob =</span> <span class="fl">0.95</span>)) <span class="co"># 95% credible intervals</span></span>
<span id="cb2-31"><a href="#cb2-31"></a></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="co"># data frame of samples from the posterior distribution</span></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="co"># This allows you to calculate posterior means and functions of coefficients.</span></span>
<span id="cb2-34"><a href="#cb2-34"></a>post_non <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ORbayes_non)</span>
<span id="cb2-35"><a href="#cb2-35"></a></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="co"># point estimates and credible intervals for pdds in the treated</span></span>
<span id="cb2-37"><a href="#cb2-37"></a>post_non<span class="sc">$</span>lnodds1 <span class="ot">&lt;-</span> post_non<span class="sc">$</span><span class="st">"(Intercept)"</span> <span class="sc">+</span> post_non<span class="sc">$</span>rx</span>
<span id="cb2-38"><a href="#cb2-38"></a>post_non<span class="sc">$</span>odds1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(post_non<span class="sc">$</span>lnodds1)</span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="fu">median</span>(post_non<span class="sc">$</span>lnodds1)        <span class="co"># posterior median log odds in treated rats</span></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="fu">median</span>(post_non<span class="sc">$</span>odds1)          <span class="co"># posterior median odds in treated rats</span></span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="fu">quantile</span>(post_non<span class="sc">$</span>odds1, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)) <span class="co"># 95% credible interval for odds</span></span>
<span id="cb2-42"><a href="#cb2-42"></a></span>
<span id="cb2-43"><a href="#cb2-43"></a><span class="co"># point estimates and credible intervals for risks and risk ratios</span></span>
<span id="cb2-44"><a href="#cb2-44"></a>expit <span class="ot">&lt;-</span> <span class="cf">function</span>(v) <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>v))</span>
<span id="cb2-45"><a href="#cb2-45"></a>post_non<span class="sc">$</span>risk0 <span class="ot">&lt;-</span> <span class="fu">expit</span>(post_non<span class="sc">$</span><span class="st">"(Intercept)"</span>)</span>
<span id="cb2-46"><a href="#cb2-46"></a>post_non<span class="sc">$</span>risk1 <span class="ot">&lt;-</span> <span class="fu">expit</span>(post_non<span class="sc">$</span>lnodds1)</span>
<span id="cb2-47"><a href="#cb2-47"></a>post_non<span class="sc">$</span>oddsratio <span class="ot">&lt;-</span> <span class="fu">exp</span>(post_non<span class="sc">$</span>rx)</span>
<span id="cb2-48"><a href="#cb2-48"></a>post_non<span class="sc">$</span>riskratio <span class="ot">&lt;-</span> post_non<span class="sc">$</span>risk1 <span class="sc">/</span> post_non<span class="sc">$</span>risk0</span>
<span id="cb2-49"><a href="#cb2-49"></a><span class="fu">median</span>(post_non<span class="sc">$</span>riskratio)</span>
<span id="cb2-50"><a href="#cb2-50"></a><span class="fu">quantile</span>(post_non<span class="sc">$</span>riskratio, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb2-51"><a href="#cb2-51"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="accelerated-failure-time-models" class="level3" data-number="12.3.3">
<h3 data-number="12.3.3" class="anchored" data-anchor-id="accelerated-failure-time-models"><span class="header-section-number">12.3.3</span> Accelerated failure time models</h3>
</section>
<section id="proportional-hazards-models" class="level3" data-number="12.3.4">
<h3 data-number="12.3.4" class="anchored" data-anchor-id="proportional-hazards-models"><span class="header-section-number">12.3.4</span> Proportional hazards models</h3>
</section>
</section>
<section id="case-control-studies" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="case-control-studies"><span class="header-section-number">12.4</span> Case-control studies</h2>
<section id="conditional-logistic-regression" class="level3" data-number="12.4.1">
<h3 data-number="12.4.1" class="anchored" data-anchor-id="conditional-logistic-regression"><span class="header-section-number">12.4.1</span> Conditional logistic regression</h3>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-duane1987hybrid" class="csl-entry" role="listitem">
Duane, Simon, Anthony D Kennedy, Brian J Pendleton, and Duncan Roweth. 1987. <span>“Hybrid <span>Monte Carlo</span>.”</span> <em>Physics Letters B</em> 195 (2): 216–22.
</div>
<div id="ref-gelman2013bayesian" class="csl-entry" role="listitem">
Gelman, Andrew, John B Carlin, Hal S Stern, David B Dunson, Aki Vehtari, and Donald B Rubin. 2014. <em>Bayesian Data Analysis</em>. Third. CRC press.
</div>
<div id="ref-greenland1998probability" class="csl-entry" role="listitem">
Greenland, Sander. 1998. <span>“Probability Logic and Probabilistic Induction.”</span> <em>Epidemiology</em> 9 (3): 322–32.
</div>
<div id="ref-hastings1970monte" class="csl-entry" role="listitem">
Hastings, W Keith. 1970. <span>“<span>Monte Carlo</span> Sampling Methods Using <span>Markov</span> Chains and Their Applications.”</span> <em>Biometrika</em> 57 (1): 97–109.
</div>
<div id="ref-metropolis1953equation" class="csl-entry" role="listitem">
Metropolis, Nicholas, Arianna W Rosenbluth, Marshall N Rosenbluth, Augusta H Teller, and Edward Teller. 1953. <span>“Equation of State Calculations by Fast Computing Machines.”</span> <em>The Journal of Chemical Physics</em> 21 (6): 1087–92.
</div>
<div id="ref-neal1996monte" class="csl-entry" role="listitem">
Neal, Radford M. 1996. <span>“<span>Monte Carlo</span> Implementation.”</span> <em>Bayesian Learning for Neural Networks</em>, 55–98.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./casecontrol.html" class="pagination-link" aria-label="Design and Analysis of Case-Control and Case-Cohort studies">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design and Analysis of Case-Control and Case-Cohort studies</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./causality.html" class="pagination-link" aria-label="Causality in Public Health">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Causality in Public Health</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>