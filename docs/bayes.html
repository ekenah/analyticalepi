<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Bayesian Estimation – Analytical Epidemiology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./longitudinal.html" rel="next">
<link href="./mlestimation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-747bc48f972f7c4036e4d8e8c6d9e55a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
  window.MathJax = {
    tex: {
      macros: {
        A: "\\mathcal\{A\}",
        approxsim: "\\stackrel\{\\text\{approx\}\}\{\\sim\}",
        B: "\\mathcal\{B\}",
        Bernoulli: ["\\operatorname\{Bernoulli\}"],
        binomial: ["\\operatorname\{binomial\}"],
        C: "\\mathcal\{C\}",
        chisqH: "\\chi^2_\\text\{H\}",
        chisqP: "\\chi^2_\\text\{P\}",
        chisqPobs: "\\chi^2_\\text\{Pobs\}",
        cHR: "\\text\{cHR\}",
        cloglog: ["\\operatorname\{cloglog\}"],
        comp: "\\mathsf\{C\}",
        Cov: ["\\operatorname\{Cov\}"],
        D: "\\mathcal\{D\}",
        data: "\\text\{data\}",
        dif: "\\text\{d\}",
        Dminus: "\\text\{D\}^-",
        Dplus: "\\text\{D\}^+",
        E: ["\\operatorname\{\\mathbb\{E\}\}"],
        ESSR: "\\text\{ESSR\}",
        expit: ["\\operatorname\{expit\}"],
        given: ["\\, #1| \\, ", 1],
        HR: "\\text\{HR\}",
        indep: "\\perp\\!\\!\\!\\perp",
        indicator: "\\mathbb\{1\}",
        IRR: "\\text\{IRR\}",
        K: "\\mathcal\{K\}",
        logit: ["\\operatorname\{logit\}"],
        margins: "\\text\{margins\}",
        obs: "\\text\{obs\}",
        odds: ["\\operatorname\{odds\}"],
        OR: "\\text\{OR\}",
        ptrue: "p_\{\\text\{true\}\}",
        R: "\\mathcal\{R\}",
        RD: "\\text\{RD\}",
        RR: "\\text\{RR\}",
        sens: "\\text\{sens\}",
        spec: "\\text\{spec\}",
        supp: ["\\operatorname\{supp\}"],
        tcens: "t^\\text\{cens\}",
        tentry: "t^\\text\{entry\}",
        tevent: "t^\\text\{event\}",
        texit: "t^\\text\{exit\}",
        Tminus: "\\text\{T\}^-",
        tonset: "t^\\text\{onset\}",
        Tplus: "\\text\{T\}^+",
        transpose: "\\mathsf{T}",
        trec: "t^\\text\{rec\}",
        true: "\\text\{true\}",
        twobytwo: "2 \\times 2",
        vand: "\\text\{ and \}",
        Var: ["\\operatorname\{Var\}"],
        Xminus: "\\text\{X\}^-",
        Xobs: "\\text\{X\}^\\text\{obs\}",
        Xplus: "\\text\{X\}^+"
      }
    }
  };
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./probability.html">Defining and Measuring Disease Occurrence</a></li><li class="breadcrumb-item"><a href="./bayes.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian Estimation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analytical Epidemiology</a> 
        <div class="sidebar-tools-main">
    <a href="./Analytical-Epidemiology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Defining and Measuring Disease Occurrence</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability, Random Variables, and Disease Occurrence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./condprob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Conditional Probability and Diagnostic Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlestimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Maximum Likelihood Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian Estimation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Longitudinal Data, Rates, and Counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">One-Sample Survival Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Study Design and Measures of Association</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./studydesign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Cohort and Case-Control Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Internal and External Validity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cohort.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Measures of Association in Cohort Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Two-Sample Survival Analysis and the Cox Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./casecontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Design and Analysis of Case-Control and Case-Cohort studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bayesian analysis of cohort and case-control studies</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Principles of Causal Inference</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Epidemologic and Statistical Methods for Causal Inference</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Calculus</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#prior-and-posterior-distributions" id="toc-prior-and-posterior-distributions" class="nav-link active" data-scroll-target="#prior-and-posterior-distributions"><span class="header-section-number">4.1</span> Prior and posterior distributions</a>
  <ul class="collapse">
  <li><a href="#posterior-point-and-interval-estimation" id="toc-posterior-point-and-interval-estimation" class="nav-link" data-scroll-target="#posterior-point-and-interval-estimation"><span class="header-section-number">4.1.1</span> Posterior point and interval estimation</a></li>
  <li><a href="#bayesian-interpretation-of-confidence-intervals" id="toc-bayesian-interpretation-of-confidence-intervals" class="nav-link" data-scroll-target="#bayesian-interpretation-of-confidence-intervals"><span class="header-section-number">4.1.2</span> Bayesian interpretation of confidence intervals</a></li>
  <li><a href="#posterior-probability-of-h_0-and-p-values" id="toc-posterior-probability-of-h_0-and-p-values" class="nav-link" data-scroll-target="#posterior-probability-of-h_0-and-p-values"><span class="header-section-number">4.1.3</span> Posterior probability of <span class="math inline">\(H_0\)</span> and p-values</a></li>
  </ul></li>
  <li><a href="#bayesian-estimation-of-a-probability" id="toc-bayesian-estimation-of-a-probability" class="nav-link" data-scroll-target="#bayesian-estimation-of-a-probability"><span class="header-section-number">4.2</span> Bayesian estimation of a probability</a>
  <ul class="collapse">
  <li><a href="#beta-distribution" id="toc-beta-distribution" class="nav-link" data-scroll-target="#beta-distribution"><span class="header-section-number">4.2.1</span> Beta distribution</a></li>
  <li><a href="#posterior-point-and-interval-estimates" id="toc-posterior-point-and-interval-estimates" class="nav-link" data-scroll-target="#posterior-point-and-interval-estimates"><span class="header-section-number">4.2.2</span> Posterior point and interval estimates</a></li>
  <li><a href="#jeffreys-confidence-interval" id="toc-jeffreys-confidence-interval" class="nav-link" data-scroll-target="#jeffreys-confidence-interval"><span class="header-section-number">4.2.3</span> Jeffreys confidence interval</a></li>
  </ul></li>
  <li><a href="#comparison-of-binomial-confidence-intervals" id="toc-comparison-of-binomial-confidence-intervals" class="nav-link" data-scroll-target="#comparison-of-binomial-confidence-intervals"><span class="header-section-number">4.3</span> Comparison of binomial confidence intervals</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./probability.html">Defining and Measuring Disease Occurrence</a></li><li class="breadcrumb-item"><a href="./bayes.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian Estimation</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-bayes" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bayesian Estimation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>In the null hypothesis schema we are trying only to nullify something: “The null hypothesis is never proved or established but is possibly disproved in the course of experimentation.” But ordinarily evidence does not take this form. With the <em>corpus delicti</em> in front of you, you do not say, “Here is evidence against the hypothesis that no one is dead.” You say, “Evidently someone has been murdered.” <span class="citation" data-cites="berkson1942tests">(<a href="references.html#ref-berkson1942tests" role="doc-biblioref">Berkson 1942</a>)</span><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</blockquote>
<p>In <strong>Bayesian</strong> inference, probability distributions are used to summarize our knowledge about the possible values of an unknown parameter <span class="math inline">\(\theta_\true\)</span>. The distribution of possible values of <span class="math inline">\(\theta_\true\)</span> before we have seen our data is called the <strong>prior distribution</strong>, and the distribution of possible values of <span class="math inline">\(\theta_\true\)</span> after we see the data is called the <strong>posterior distribution</strong>. Most parameters we are interested in estimating (such as probabilities) are continuous, so they have a probability density function (PDF) instead of a probability mass function (PMF). The posterior PDF is proportional to the prior PDF times the likelihood function, and the posterior distribution can be used to get point and interval estimates of an unknown parameter. The interval estimates are called <strong>credible intervals</strong>, and they have important advantages over confidence intervals. The Bayesian approach to statistics is more logically consistent and more intuitive than the frequentist approach, but it can be more computationally complex. While large-sample theory can be useful in Bayesian inference, it does not rely on asymptotic normality to the same degree that maximum likelihood estimation does.</p>
<section id="prior-and-posterior-distributions" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="prior-and-posterior-distributions"><span class="header-section-number">4.1</span> Prior and posterior distributions</h2>
<p>The value of a PDF is not a probability (it can be greater than one), but PDFs can be handled like probabilities in terms of the addition rule and the multiplication of conditional probabilities <span class="citation" data-cites="gelman2013bayesian">Boos and Stefanski (<a href="references.html#ref-boos2013essential" role="doc-biblioref">2013</a>)</span>. Let <span class="math inline">\(\pi(\theta)\)</span> be the <strong>prior</strong> PDF of <span class="math inline">\(\theta\)</span>. Before we see our data, we believe that <span class="math inline">\(\theta_\true \in [a, b]\)</span> with probability <span class="math display">\[
  \Pr(a \leq \theta \leq b) = \int_a^b \pi(\theta) \,\dif \theta.
\]</span> This integral is the area under the graph of <span class="math inline">\(\pi(\theta)\)</span> between <span class="math inline">\(\theta = a\)</span> and <span class="math inline">\(\theta = b\)</span>. For a given value of <span class="math inline">\(\theta\)</span>, the likelihood of our data is <span class="math inline">\(L(\theta) = \pi(\data \given{} \theta)\)</span>. By Bayes’ rule, the <strong>posterior</strong> PDF is <span class="math display">\[
  \pi(\theta \given{} \data)
  = \frac{L(\theta) \pi(\theta)}{\pi(\data)}
  \propto L(\theta) \pi(\theta).
\]</span> where <span class="math inline">\(\propto\)</span> denotes “proportional to.” Calculating <span class="math inline">\(\pi(\data)\)</span> is difficult and almost always unnecessary. As long as we can calculate <span class="math inline">\(\pi(\theta \given{} \data)\)</span> up to a constant of proportionality, we can normalize it to ensure that we have a posterior PDF whose integral over <span class="math inline">\(\mathbb{R}\)</span> equals one. After we see our data, we believe that <span class="math inline">\(\theta_\true \in [a, b]\)</span> with probability <span class="math display">\[
  \Pr(a \leq \theta \leq b \given{} \data)
  = \int_a^b \pi(\theta \given{} \data) \,\dif \theta.
\]</span> Bayesian point and interval estimates of <span class="math inline">\(\theta_\true\)</span> are based on the posterior PDF.</p>
<p>Bayesian methods are often simpler, easier to interpret, and more robust to small sample sizes than frequentist methods like maximum likelihood estimation. In the limit of a large sample size, Bayesian and frequentist methods almost always give equivalent results. The Bayesian approach is also valuable because it emphasizes estimation and the accumulation of knowledge rather than binary decisions <span class="citation" data-cites="tukey1960conclusions">(<a href="references.html#ref-tukey1960conclusions" role="doc-biblioref">Tukey 1960</a>)</span>. However, the adoption of Bayesian methods has been impeded by a historical lack of the computational power needed to use them and by the widespread hesitation to specify prior distributions among epidemiologists, statisticians, and other scientists. The first problem is largely solved, but the latter problem remains with us today.</p>
<p>A common approach to specifying a prior distribution is to use a <strong>noninformative prior</strong> that places few or no restrictions on the value of <span class="math inline">\(\theta\)</span>. This lets the data “speak for itself” at the price of ignoring existing knowledge about the underlying scientific question. The ability to incorporate an informative prior distribution in the Bayesian approach to statistical inference should be viewed as a feature, not a bug <span class="citation" data-cites="greenland2006bayesian greenland2013living">(<a href="references.html#ref-greenland2006bayesian" role="doc-biblioref">Greenland 2006</a>; <a href="references.html#ref-greenland2013living" role="doc-biblioref">Greenland and Poole 2013</a>)</span>.</p>
<section id="posterior-point-and-interval-estimation" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="posterior-point-and-interval-estimation"><span class="header-section-number">4.1.1</span> Posterior point and interval estimation</h3>
<p>The mean, median, or mode of the posterior distribution of <span class="math inline">\(\theta\)</span> can be used as a point estimate of <span class="math inline">\(\theta_\true\)</span>. We will use <span class="math inline">\(\bar{\theta}\)</span> to denote the posterior mean and <span class="math inline">\(\tilde{\theta}\)</span> to denote the posterior median. In large samples, the posterior distribution converges to a normal distribution with mean <span class="math inline">\(\theta_\true\)</span> and variance <span class="math inline">\(I(\theta_\true)^{-1}\)</span> <span class="citation" data-cites="lecam1953some gelman2013bayesian">(<a href="references.html#ref-lecam1953some" role="doc-biblioref">Le Cam 1953</a>; <a href="references.html#ref-gelman2013bayesian" role="doc-biblioref">Gelman et al. 2013</a>)</span>,<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> which is the same as the limiting normal distribution of the MLE <span class="math inline">\(\hat{\theta}\)</span>. In this limit, the posterior mean, median, and mode are all equal to <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p>A <strong><span class="math inline">\(1 - \alpha\)</span> credible interval</strong> is an interval <span class="math inline">\([a, b]\)</span> such that <span class="math display">\[
  \Pr(a \leq \theta \leq b \given{} \data)
  = \int_a^b \pi(\theta \given{} \data) \,\dif \theta
  = 1 - \alpha.
\]</span> Given our data, we believe that <span class="math inline">\(\theta_\true \in [a, b]\)</span> with probability <span class="math inline">\(1 - \alpha\)</span>. There are many different ways that a credible interval can be defined. The one that is conceptually closest to a confidence interval is the <strong>central posterior interval</strong> or <strong>equal-tailed interval</strong>, where <span class="math display">\[
  \Pr(\theta &lt; a \given{} \data) = \Pr(\theta &gt; b \given{} \data)
  = \frac{\alpha}{2}.
\]</span> Thus, the <span class="math inline">\(1 - \alpha\)</span> confidence limits are the <span class="math inline">\(\alpha / 2\)</span> and <span class="math inline">\(1 - \alpha / 2\)</span> quantiles of the posterior distribution of <span class="math inline">\(\theta_\true\)</span>. Unlike confidence intervals, credible intervals can accurately be interpreted as containing <span class="math inline">\(\theta_\true\)</span> with probability <span class="math inline">\(1 - \alpha\)</span>. Like confidence intervals, credible intervals are only reliable if the likelihood is approximately correct. An equal-tailed credible interval is guaranteed to contain the posterior median <span class="math inline">\(\tilde{\theta}\)</span>. It will usually contain the posterior mean <span class="math inline">\(\bar{\theta}\)</span>, but this is not guaranteed in small samples.</p>
</section>
<section id="bayesian-interpretation-of-confidence-intervals" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="bayesian-interpretation-of-confidence-intervals"><span class="header-section-number">4.1.2</span> Bayesian interpretation of confidence intervals</h3>
<p>Bayesian credible intervals actually have the properties that people intuitively but naively expect of frequentist confidence intervals. In finite samples, a <span class="math inline">\(1 - \alpha\)</span> equal-tailed credible interval and a <span class="math inline">\(1 - \alpha\)</span> confidence interval will be similar when the posterior density <span class="math inline">\(\pi(\theta \given{} \data)\)</span> is proportional to the likelihood <span class="math inline">\(L(\theta) = \pi(\theta \given{} \data)\)</span>. This occurs when <span class="math inline">\(\pi(\theta)\)</span> is constant, as in some uninformative priors. In the limit of a large sample, the credible interval and the confidence interval are nearly identical. In general, a frequentist confidence interval can be interpreted as an approximation to a Bayesian credible interval when there is a large sample and a prior distribution that is flat across the range of the confidence interval <span class="citation" data-cites="pratt1965bayesian greenland2013living">(<a href="references.html#ref-pratt1965bayesian" role="doc-biblioref">Pratt 1965</a>; <a href="references.html#ref-greenland2013living" role="doc-biblioref">Greenland and Poole 2013</a>)</span>. However, credible intervals do not rely on large-sample approximations, and they are able to incorporate prior knowledge about the possible values of <span class="math inline">\(\theta_\true\)</span>.</p>
</section>
<section id="posterior-probability-of-h_0-and-p-values" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="posterior-probability-of-h_0-and-p-values"><span class="header-section-number">4.1.3</span> Posterior probability of <span class="math inline">\(H_0\)</span> and p-values</h3>
<p>The idea of prior and posterior probabilities from Bayesian inference gives us a useful perspective on the interpretation of p-values, which is a source of much confusion in epidemiology <span class="citation" data-cites="diamond1983clinical greenland2016statistical baduashvili2020understand">(<a href="references.html#ref-diamond1983clinical" role="doc-biblioref">Diamond and Forrester 1983</a>; <a href="references.html#ref-greenland2016statistical" role="doc-biblioref">Greenland et al. 2016</a>; <a href="references.html#ref-baduashvili2020understand" role="doc-biblioref">Baduashvili, Evans, and Cutler 2020</a>)</span>. The most common error is to interpret the p-value as the posterior probability that <span class="math inline">\(H_0\)</span> is true. By Bayes’ rule, <span class="math display">\[
  \Pr(H_0 \ \true \given{} \data)
  = \frac{\Pr(\data \given{} H_0 \ \true) \Pr(H_0 \ \true)}{\Pr(\data)}.
\]</span> The p-value is analogous to <span class="math inline">\(\Pr(\data \given{} H_0 \ \true)\)</span>, but the posterior probability <span class="math inline">\(\Pr(H_0 \text{ true} \given{} \ \data)\)</span> depends on its prior probability <span class="math inline">\(\Pr(H_0)\)</span>. It should take more data to convince us of a null hypothesis that seemed very unlikely than to convince us of a null hypothesis that seemed very likely.</p>
<p>For a null hypothesis of the form <span class="math inline">\(H_0: \theta_\true = \theta_0\)</span> where <span class="math inline">\(\theta\)</span> ranges over an interval, it can be difficult to assign a prior probability to <span class="math inline">\(H_0\)</span>. For any continuous distribution of <span class="math inline">\(\theta\)</span>, the probability that it takes any particular value is zero. One way around this difficulty is to assign a prior probability mass to the null value <span class="math inline">\(\theta_0\)</span>. A more difficult problem is to assign a prior probability to the alternative hypothesis <span class="math inline">\(H_1\)</span>, which is often not clearly specified. This means that the posterior probability of the null hypothesis is often not clearly defined.</p>
<p>However, it is not difficult to calculate a lower bound on the probability that <span class="math inline">\(H_0\)</span> is true given the data <span class="citation" data-cites="edwards1963bayesian berger1987testing">(<a href="references.html#ref-edwards1963bayesian" role="doc-biblioref">Edwards, Lindman, and Savage 1963</a>; <a href="references.html#ref-berger1987testing" role="doc-biblioref">Berger and Sellke 1987</a>)</span>. Let <span class="math inline">\(\pi_0\)</span> be the prior probability of <span class="math inline">\(H_0\)</span>, and suppose we have a single alternative hypothesis <span class="math inline">\(H_1: \theta_\true = \theta_1\)</span> with prior probability <span class="math inline">\(1 - \pi_0\)</span>. Then the posterior probability of <span class="math inline">\(H_0\)</span> is <span class="math display">\[
  \Pr(H_0 \given{} \data)
  = \frac{L(\theta_0) \pi_0}{L(\theta_0) \pi_0 + L(\theta_1) (1 - \pi_0)}
  = \bigg(1 + \frac{1 - \pi_0}{\pi_0} \frac{L(\theta_1)}{L(\theta_0)}\bigg)^{-1}.
\]</span> Given the data, the posterior probability of <span class="math inline">\(H_0\)</span> is minimized if we happen to get the MLE <span class="math inline">\(\hat{\theta} = \theta_1\)</span>, so <span class="math display">\[
  \Pr(H_0 \ \true \given{} \data)
  \geq \bigg(1 + \frac{1 - \pi_0}{\pi_0}\frac{L(\hat{\theta})}{L(\theta_0)}\bigg)^{-1}.
\]</span> From Wilk’s theorem <span class="citation" data-cites="wilks1938large">(<a href="references.html#ref-wilks1938large" role="doc-biblioref">Wilks 1938</a>)</span> for the likelihood ratio test, twice the log likelihood ratio has an approximate <span class="math inline">\(\chi^2_1\)</span> distribution in large samples. To get a p-value of <span class="math inline">\(\alpha\)</span> from the likelihood ratio test, we need <span class="math display">\[
  2\big(\ell(\hat{\theta}) - \ell(\theta_0)\big)
  = z_{1 - \frac{\alpha}{2}}^2
  \;\Rightarrow\;
  \frac{L(\hat{\theta})}{L(\theta_0)}
   = e^{\frac{1}{2} z_{1 - \frac{\alpha}{2}}^2}.
\]</span> <a href="#fig-postH0" class="quarto-xref">Figure&nbsp;<span>4.1</span></a> shows the minimum posterior probability of <span class="math inline">\(H_0\)</span> if <span class="math inline">\(\pi_0 = 0.5\)</span> for different p-values. The p-value is almost always much lower than the lower bound of the posterior probability of the null. For <span class="math inline">\(\pi_0 = 0.5\)</span>, the lower bounds for <span class="math inline">\(\Pr(H_0 \ \true \given{} \data)\)</span> are approximately 0.205 for <span class="math inline">\(p = 0.10\)</span>, 0.128 for <span class="math inline">\(p = 0.05\)</span>, and 0.035 for <span class="math inline">\(p = 0.01\)</span>. In practice, the posterior probability of <span class="math inline">\(H_0\)</span> can be much larger than its lower bound <span class="citation" data-cites="berger1987testing">(<a href="references.html#ref-berger1987testing" role="doc-biblioref">Berger and Sellke 1987</a>)</span>.</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>postH0.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Posterior probability of the null hypothesis (H0)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># function to calculate lower bound</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>lowerb <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">pi0=</span><span class="fl">0.5</span>, <span class="at">pval=</span><span class="fl">0.05</span>) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># args: pi0 = prior probability of H0, pval = p-value</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return: lower bound on posterior probability of H0</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> pval <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> pi0) <span class="sc">/</span> pi0 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.5</span> <span class="sc">*</span> z<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of lower bounds for p-value = 0.01, 0.05, and 0.1</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">lowerb</span>(x), <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">"Prior probability of H"</span>[<span class="dv">0</span>]),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">"Minimum posterior probability of H"</span>[<span class="dv">0</span>]))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">lowerb</span>(x))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">lowerb</span>(x, <span class="at">pval =</span> .<span class="dv">01</span>), <span class="at">lty =</span> <span class="st">"dashed"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">lowerb</span>(x, <span class="at">pval =</span> .<span class="dv">1</span>), <span class="at">lty =</span> <span class="st">"dotted"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="st">"dotted"</span>, <span class="st">"solid"</span>, <span class="st">"dashed"</span>),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"p = 0.10"</span>, <span class="st">"p = 0.05"</span>, <span class="st">"p = 0.01"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output-display">
<div id="fig-postH0" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-postH0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayes_files/figure-html/fig-postH0-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;4.1: The minimum posterior probability of H_0 as a function of its prior probability \pi_0 for p-values of 0.01, 0.05, and 0.1. These posterior probabilities can be much higher than the p-value."><img src="bayes_files/figure-html/fig-postH0-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-postH0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: The minimum posterior probability of <span class="math inline">\(H_0\)</span> as a function of its prior probability <span class="math inline">\(\pi_0\)</span> for p-values of 0.01, 0.05, and 0.1. These posterior probabilities can be much higher than the p-value.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="bayesian-estimation-of-a-probability" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="bayesian-estimation-of-a-probability"><span class="header-section-number">4.2</span> Bayesian estimation of a probability</h2>
<p>When estimating a probability <span class="math inline">\(\ptrue\)</span>, our likelihood will be the binomial likelihood <span class="math display">\[
  L(p) = \binom{n}{k} p^k (1 - p)^{n - x}
\]</span> when <span class="math inline">\(k\)</span> out of <span class="math inline">\(n\)</span> samples equal one. Because we only need to calculate the likelihood up to a constant of proportionality, we can safely ignore the <span class="math inline">\(\binom{n}{k}\)</span> because it does not depend on <span class="math inline">\(p\)</span>. The posterior distribution of <span class="math inline">\(p\)</span> will be <span class="math display">\[
  \pi(p \given{} \data) \propto p^k (1 - p)^{n - k} \pi(p)
\]</span> where <span class="math inline">\(\pi(p)\)</span> is the prior distribution of <span class="math inline">\(p\)</span>. When <span class="math inline">\(\pi(p \given{} \data)\)</span> and <span class="math inline">\(\pi(p)\)</span> are from the same family of distributions, the prior <span class="math inline">\(\pi(p)\)</span> is said to be a <strong>conjugate</strong> distribution for the binomial likelihood. Conjugate distributions exist for many likelihoods used in epidemiology.</p>
<section id="beta-distribution" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="beta-distribution"><span class="header-section-number">4.2.1</span> Beta distribution</h3>
<p>The conjugate distribution for the binomial likelihood is the <strong>beta distribution</strong>. It has is a support on <span class="math inline">\([0, 1]\)</span> (where <span class="math inline">\(p_\true\)</span> must live) with the PDF <span class="math display">\[
  f(x, \alpha, \beta)
  = \frac{\Gamma(\alpha + \beta)}{\Gamma(\alpha) \Gamma(\beta)}
    x^{\alpha - 1} (1 - x)^{\beta - 1}
  \propto x^{\alpha - 1} (1 - x)^{\beta - 1}.
\]</span> where <span class="math inline">\(\alpha &gt; 0\)</span> and <span class="math inline">\(\beta &gt; 0\)</span> are shape parameters and <span class="math inline">\(\Gamma(v)\)</span> is the gamma function.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Because we will only need to calculate PDFs up to a mutiplicative constant, the gamma function term can be safely ignored. If <span class="math inline">\(X \sim \text{beta}(\alpha, \beta)\)</span>, then <span class="math display">\[
  \E[X] = \frac{\alpha}{\alpha + \beta}
\]</span> and <span class="math display">\[
  \Var(X) = \frac{\alpha \beta}{(\alpha + \beta)^2 (\alpha + \beta + 1)}.
\]</span> The beta distribution has a number of important special cases:</p>
<ul>
<li><p>When <span class="math inline">\(\alpha = \beta = 1\)</span>, it is a uniform(<span class="math inline">\(0, 1\)</span>) distribution.</p></li>
<li><p>The beta distribution with <span class="math inline">\(\alpha = \beta = 1 / 2\)</span> is the <strong>Jeffreys prior</strong> for the binomial likelihood.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> A Jeffreys prior is proportional to the square root of the expected information <span class="math inline">\(\mathcal{I}_1(\theta)\)</span> of a single observation<span class="citation" data-cites="jeffreys1946invariant">(<a href="references.html#ref-jeffreys1946invariant" role="doc-biblioref">Jeffreys 1946</a>)</span>. They are widely used as noninformative priors. For the binomial likelihood, <span class="math inline">\(\mathcal{I}_1(p) = \frac{1}{p (1 - p)}\)</span>.</p></li>
</ul>
</section>
<section id="posterior-point-and-interval-estimates" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="posterior-point-and-interval-estimates"><span class="header-section-number">4.2.2</span> Posterior point and interval estimates</h3>
<p>If the prior distribution of <span class="math inline">\(p\)</span> is a beta(<span class="math inline">\(\alpha, \beta\)</span>) distribution, then <span class="math display">\[
  \begin{aligned}
    \pi(p \given \data)
    &amp;\propto p^k (1 - p)^{n - k} \times p^{\alpha - 1} (1 - p)^{\beta - 1} \\
    &amp;= p^{k + \alpha - 1} (1 - p)^{n - k + \beta - 1}
  \end{aligned}
\]</span> so the posterior distribution of <span class="math inline">\(p\)</span> is a beta(<span class="math inline">\(k + \alpha, n - k + \beta\)</span>) distribution. The posterior mean is <span class="math display">\[
  \bar{p} = \frac{k + \alpha}{(k + \alpha) + (n - k + \beta)}
  = \frac{k + \alpha}{n + \alpha + \beta},
\]</span> and the posterior variance is <span class="math display">\[
  \frac{(k + \alpha) (n - k + \beta)}{(n + \alpha + \beta)^2 (n + \alpha + \beta + 1)}
  = \frac{\bar{p} (1 - \bar{p})}{n + \alpha + \beta + 1}.
\]</span> The endpoints of the <span class="math inline">\(1 - \alpha\)</span> central credible interval are the <span class="math inline">\(\alpha / 2\)</span> and <span class="math inline">\(1 - \alpha / 2\)</span> quantiles of the beta(<span class="math inline">\(k + \alpha, n - k + \beta)\)</span> distribution. <a href="#fig-binom-Bayes" class="quarto-xref">Figure&nbsp;<span>4.2</span></a> shows prior and posterior distributions for 15 successes out of 22 trials. Although the prior distributions are quite different, the posterior distributions are quite similar. With large samples, the prior distribution disappears into the likelihood.</p>
<div class="cell">
<div class="code-with-filename">
<details class="code-fold">
<summary>Code</summary>
<div class="code-with-filename-file">
<pre><strong>normplots.R</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Bayesian prior and posterior distributions for a probability</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># beta prior and posterior distributions</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The prior is beta(1, 1), which is the uniform(0, 1) distribution.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Because k = 15 and n = 22, the posterior is beta(15 + 1, 22 - 15 + 1)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="fu">dbeta</span>(p, <span class="dv">16</span>, <span class="dv">8</span>), <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"p"</span>, <span class="at">ylab =</span> <span class="st">"Probability density"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p, <span class="fu">dbeta</span>(p, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="st">"dashed"</span>)  <span class="co"># prior PDF</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p, <span class="fu">dbeta</span>(p, <span class="dv">16</span>, <span class="dv">8</span>))                 <span class="co"># posterior PDF</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>postlower <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.025</span>, <span class="dv">16</span>, <span class="dv">8</span>)          <span class="co"># 95% credible interval lower bound</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>postupper <span class="ot">&lt;-</span> <span class="fu">qbeta</span>(<span class="fl">0.975</span>, <span class="dv">16</span>, <span class="dv">8</span>)          <span class="co"># 95% credible interval upper bound</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">seq</span>(<span class="dv">0</span>, postlower, <span class="at">by =</span> <span class="fl">0.01</span>), postlower),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dbeta</span>(<span class="fu">seq</span>(<span class="dv">0</span>, postlower, <span class="at">by =</span> <span class="fl">0.01</span>), <span class="dv">16</span>, <span class="dv">8</span>), <span class="dv">0</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"darkgray"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(postupper, <span class="fu">seq</span>(postupper, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>), <span class="dv">1</span>),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dbeta</span>(<span class="fu">seq</span>(postupper, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>), <span class="dv">16</span>, <span class="dv">8</span>), <span class="dv">0</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"darkgray"</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">bg =</span> <span class="st">"white"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"solid"</span>, <span class="cn">NA</span>, <span class="st">"dashed"</span>, <span class="st">"solid"</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"black"</span>, <span class="cn">NA</span>, <span class="st">"darkgray"</span>, <span class="st">"darkgray"</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"darkgray"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">border =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"black"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"uniform prior"</span>, <span class="st">"posterior (uniform)"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"2.5% tails (uniform)"</span>, <span class="st">"Jeffreys prior"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"posterior (Jeffreys)"</span>))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p, <span class="fu">dbeta</span>(p, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">lty =</span> <span class="st">"dashed"</span>, <span class="at">col =</span> <span class="st">"darkgray"</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(p, <span class="fu">dbeta</span>(p, <span class="fl">15.5</span>, <span class="fl">7.5</span>), <span class="at">col =</span> <span class="st">"darkgray"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell-output-display">
<div id="fig-binom-Bayes" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-binom-Bayes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="bayes_files/figure-html/fig-binom-Bayes-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;4.2: Prior and posterior distributions for p after observing 15 successes out of 22 trials. The uniform prior and the resulting posterior distribution are shown in black with the 2.5% tails shaded. The central 95% credible interval includes all values of p between the two tails. The Jeffreys prior and the corresponding posterior distribution are shown in dark gray."><img src="bayes_files/figure-html/fig-binom-Bayes-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-binom-Bayes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Prior and posterior distributions for <span class="math inline">\(p\)</span> after observing 15 successes out of 22 trials. The uniform prior and the resulting posterior distribution are shown in black with the 2.5% tails shaded. The central 95% credible interval includes all values of <span class="math inline">\(p\)</span> between the two tails. The Jeffreys prior and the corresponding posterior distribution are shown in dark gray.
</figcaption>
</figure>
</div>
</div>
</div>
<p>As <span class="math inline">\(n \rightarrow \infty\)</span>, we have <span class="math inline">\(\bar{p} - \hat{p} \rightarrow 0\)</span> and <span class="math display">\[\frac{\bar{p} (1 - \bar{p})}{n + \alpha + \beta + 1}
    - \frac{\hat{p} (1 - \hat{p})}{n} \rightarrow 0.\]</span> Thus, the posterior distribution approaches approximate normal distribution of the maximum likelihood estimate <span class="math inline">\(\hat{p}\)</span> in large samples. However, the Bayesian posterior distribution is valid for any sample size, not just large samples.</p>
</section>
<section id="jeffreys-confidence-interval" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="jeffreys-confidence-interval"><span class="header-section-number">4.2.3</span> Jeffreys confidence interval</h3>
<p>The <span class="math inline">\(1 - \alpha\)</span> Jeffreys confidence interval is the central credible interval with a beta(<span class="math inline">\(1 / 2, 1 / 2)\)</span> prior, which is the Jeffreys prior for a binomial model. When <span class="math inline">\(k &gt; 0\)</span> and <span class="math inline">\(k &lt; n\)</span>, its endpoints are the <span class="math inline">\(\alpha / 2\)</span> and <span class="math inline">\(1 - \alpha / 2\)</span> quantiles of the beta(<span class="math inline">\(k + 1 / 2, n - k + 1 / 2\)</span>) posterior distribution that we get if we see <span class="math inline">\(k\)</span> successes in <span class="math inline">\(n\)</span> trials. When <span class="math inline">\(k = 0\)</span>, the lower endpoint is 0. When <span class="math inline">\(k = n\)</span>, the upper endpoint is 1. For a binomial proportion, the Jeffreys confidence interval has width and coverage probability similar to the score (Wilson) and mid-p exact confidence intervals <span class="citation" data-cites="brown2001interval">(<a href="references.html#ref-brown2001interval" role="doc-biblioref">Brown, Cai, and DasGupta 2001</a>)</span>.</p>
</section>
</section>
<section id="comparison-of-binomial-confidence-intervals" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="comparison-of-binomial-confidence-intervals"><span class="header-section-number">4.3</span> Comparison of binomial confidence intervals</h2>
<p><a href="#tbl-binconfs" class="quarto-xref">Table&nbsp;<span>4.1</span></a> shows eight types of confidence intervals for a probability that we have discussed. These are calculated for the sensitivity, sensitivity, positive predictive value (PPV), and negative predictive value (NPV) of the diabetes test one hour after the meal, where a positive test was defined as a blood glucose concentration above 130 mg/dL.</p>
<div id="tbl-binconfs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-binconfs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.1: 95% confidence intervals for the sensitivity, specificity, PPV, and NPV of diabetes test in <span class="citation" data-cites="remein1961efficiency">Remein and Wilkerson (<a href="references.html#ref-remein1961efficiency" role="doc-biblioref">1961</a>)</span>.
</figcaption>
<div aria-describedby="tbl-binconfs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Sensitivity</th>
<th style="text-align: center;">Specificity</th>
<th style="text-align: center;">PPV</th>
<th style="text-align: center;">NPV</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>95% CI type</strong></td>
<td style="text-align: center;"><span class="math inline">\(55 / 70 \approx 0.786\)</span></td>
<td style="text-align: center;"><span class="math inline">\(462 / 510 \approx 0.906\)</span></td>
<td style="text-align: center;"><span class="math inline">\(55 / 103 \approx 0.534\)</span></td>
<td style="text-align: center;"><span class="math inline">\(462 / 477 \approx 0.969\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Wald</td>
<td style="text-align: center;">(0.690, 0.882)</td>
<td style="text-align: center;">(0.881, 0.931)</td>
<td style="text-align: center;">(0.438, 0.630)</td>
<td style="text-align: center;">(0.953, 0.984)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Logit</td>
<td style="text-align: center;">(0.674, 0.866)</td>
<td style="text-align: center;">(0.877, 0.928)</td>
<td style="text-align: center;">(0.438, 0.628)</td>
<td style="text-align: center;">(0.949, 0.981)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Agresti-Coull</td>
<td style="text-align: center;">(0.675, 0.867)</td>
<td style="text-align: center;">(0.877, 0.928)</td>
<td style="text-align: center;">(0.438, 0.627)</td>
<td style="text-align: center;">(0.948, 0.981)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Score</td>
<td style="text-align: center;">(0.676, 0.866)</td>
<td style="text-align: center;">(0.877, 0.928)</td>
<td style="text-align: center;">(0.438, 0.627)</td>
<td style="text-align: center;">(0.949, 0.981)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Likelihood ratio</td>
<td style="text-align: center;">(0.680, 0.871)</td>
<td style="text-align: center;">(0.879, 0.929)</td>
<td style="text-align: center;">(0.438, 0.629)</td>
<td style="text-align: center;">(0.950, 0.982)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Exact</td>
<td style="text-align: center;">(0.671, 0.875)</td>
<td style="text-align: center;">(0.877, 0.930)</td>
<td style="text-align: center;">(0.433, 0.633)</td>
<td style="text-align: center;">(0.949, 0.982)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mid-p</td>
<td style="text-align: center;">(0.678, 0.870)</td>
<td style="text-align: center;">(0.878, 0.929)</td>
<td style="text-align: center;">(0.437, 0.629)</td>
<td style="text-align: center;">(0.950, 0.982)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jeffreys</td>
<td style="text-align: center;">(0.679, 0.869)</td>
<td style="text-align: center;">(0.878, 0.929)</td>
<td style="text-align: center;">(0.438, 0.628)</td>
<td style="text-align: center;">(0.950, 0.982)</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Because of their good coverage probabilities and narrow widths, the score (Wilson), likelihood ratio, and Jeffreys intervals are recommended by <span class="citation" data-cites="agresti1998approximate">Agresti and Coull (<a href="references.html#ref-agresti1998approximate" role="doc-biblioref">1998</a>)</span> and <span class="citation" data-cites="brown2001interval">Brown, Cai, and DasGupta (<a href="references.html#ref-brown2001interval" role="doc-biblioref">2001</a>)</span>. The Agresti-Coull intervals are slightly wider than these intervals, but they have slightly higher coverage probabilities and are simpler to calculate. Mid-p exact confidence intervals are similar to the Jeffreys intervals, but they are more difficult to calculate. Exact intervals are too wide, and the Wald intervals have coverage probabilities that are often too low. The logit-transformed Wald interval has good coverage probabilities, but it can be even wider than the exact interval. In large samples (with larger samples required for probabilities near zero or one), all of the intervals are similar.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>binconf-table.R</strong></pre>
</div>
<div class="sourceCode" id="cb3" data-filename="binconf-table.R"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Comparison of binomial confidence limits</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sensitivity (55 / 70)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Use round() to get rounded numbers shown in the table.</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="at">method =</span> <span class="st">"wald"</span>), <span class="dv">3</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="at">method =</span> <span class="st">"logit"</span>), <span class="dv">3</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="at">method =</span> <span class="st">"agresti-coull"</span>), <span class="dv">3</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="at">method =</span> <span class="st">"wilson"</span>), <span class="dv">3</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="at">method =</span> <span class="st">"lik"</span>), <span class="dv">3</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="at">method =</span> <span class="st">"clopper-pearson"</span>), <span class="dv">3</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="at">method =</span> <span class="st">"midp"</span>), <span class="dv">3</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="at">method =</span> <span class="st">"jeffreys"</span>), <span class="dv">3</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Specificity (462 / 510)</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">510</span>, <span class="at">method =</span> <span class="st">"wald"</span>), <span class="dv">3</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">510</span>, <span class="at">method =</span> <span class="st">"logit"</span>), <span class="dv">3</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">510</span>, <span class="at">method =</span> <span class="st">"agresti-coull"</span>), <span class="dv">3</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">510</span>, <span class="at">method =</span> <span class="st">"wilson"</span>), <span class="dv">3</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">510</span>, <span class="at">method =</span> <span class="st">"lik"</span>), <span class="dv">3</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">510</span>, <span class="at">method =</span> <span class="st">"clopper-pearson"</span>), <span class="dv">3</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">510</span>, <span class="at">method =</span> <span class="st">"midp"</span>), <span class="dv">3</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">510</span>, <span class="at">method =</span> <span class="st">"jeffreys"</span>), <span class="dv">3</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PPV (55 / 103)</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">103</span>, <span class="at">method =</span> <span class="st">"wald"</span>), <span class="dv">3</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">103</span>, <span class="at">method =</span> <span class="st">"logit"</span>), <span class="dv">3</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">103</span>, <span class="at">method =</span> <span class="st">"agresti-coull"</span>), <span class="dv">3</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">103</span>, <span class="at">method =</span> <span class="st">"wilson"</span>), <span class="dv">3</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">103</span>, <span class="at">method =</span> <span class="st">"lik"</span>), <span class="dv">3</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">103</span>, <span class="at">method =</span> <span class="st">"clopper-pearson"</span>), <span class="dv">3</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">103</span>, <span class="at">method =</span> <span class="st">"midp"</span>), <span class="dv">3</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">55</span>, <span class="dv">103</span>, <span class="at">method =</span> <span class="st">"jeffreys"</span>), <span class="dv">3</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># NPV (462 / 477)</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">477</span>, <span class="at">method =</span> <span class="st">"wald"</span>), <span class="dv">3</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">477</span>, <span class="at">method =</span> <span class="st">"logit"</span>), <span class="dv">3</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">477</span>, <span class="at">method =</span> <span class="st">"agresti-coull"</span>), <span class="dv">3</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">477</span>, <span class="at">method =</span> <span class="st">"wilson"</span>), <span class="dv">3</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">477</span>, <span class="at">method =</span> <span class="st">"lik"</span>), <span class="dv">3</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">477</span>, <span class="at">method =</span> <span class="st">"clopper-pearson"</span>), <span class="dv">3</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">477</span>, <span class="at">method =</span> <span class="st">"midp"</span>), <span class="dv">3</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">BinomCI</span>(<span class="dv">462</span>, <span class="dv">477</span>, <span class="at">method =</span> <span class="st">"jeffreys"</span>), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-agresti1998approximate" class="csl-entry" role="listitem">
Agresti, Alan, and Brent A Coull. 1998. <span>“Approximate Is Better Than <span>‘Exact’</span> for Interval Estimation of Binomial Proportions.”</span> <em>The American Statistician</em> 52 (2): 119–26.
</div>
<div id="ref-baduashvili2020understand" class="csl-entry" role="listitem">
Baduashvili, Amiran, Arthur T Evans, and Todd Cutler. 2020. <span>“How to Understand and Teach p-Values: A Diagnostic Test Framework.”</span> <em>Journal of Clinical Epidemiology</em> 122: 49–55.
</div>
<div id="ref-berger1987testing" class="csl-entry" role="listitem">
Berger, James O, and Thomas Sellke. 1987. <span>“Testing a Point Null Hypothesis: The Irreconcilability of p Values and Evidence.”</span> <em>Journal of the American Statistical Association</em> 82 (397): 112–22.
</div>
<div id="ref-berkson1942tests" class="csl-entry" role="listitem">
Berkson, Joseph. 1942. <span>“Tests of Significance Considered as Evidence.”</span> <em>Journal of the American Statistical Association</em> 37 (219): 325–35.
</div>
<div id="ref-boos2013essential" class="csl-entry" role="listitem">
Boos, Dennis D, and Leonard A Stefanski. 2013. <em>Essential Statistical Inference</em>. Springer.
</div>
<div id="ref-brown2001interval" class="csl-entry" role="listitem">
Brown, Lawrence D, T Tony Cai, and Anirban DasGupta. 2001. <span>“Interval Estimation for a Binomial Proportion.”</span> <em>Statistical Science</em> 16 (2): 101–17.
</div>
<div id="ref-diamond1983clinical" class="csl-entry" role="listitem">
Diamond, George A, and James S Forrester. 1983. <span>“Clinical Trials and Statistical Verdicts: Probable Grounds for Appeal.”</span> <em>Annals of Internal Medicine</em> 98 (3): 385–94.
</div>
<div id="ref-edwards1963bayesian" class="csl-entry" role="listitem">
Edwards, Ward, Harold Lindman, and Leonard J Savage. 1963. <span>“Bayesian Statistical Inference for Psychological Research.”</span> <em>Psychological Review</em> 70 (3): 193–242.
</div>
<div id="ref-gelman2013bayesian" class="csl-entry" role="listitem">
Gelman, Andrew, John B Carlin, Hal S Stern, David B Dunson, Aki Vehtari, and Donald B Rubin. 2013. <em>Bayesian Data Analysis</em>. CRC press.
</div>
<div id="ref-greenland2006bayesian" class="csl-entry" role="listitem">
Greenland, Sander. 2006. <span>“Bayesian Perspectives for Epidemiological Research: I. Foundations and Basic Methods.”</span> <em>International Journal of Epidemiology</em> 35 (3): 765–75.
</div>
<div id="ref-greenland2013living" class="csl-entry" role="listitem">
Greenland, Sander, and Charles Poole. 2013. <span>“Living with p Values: Resurrecting a Bayesian Perspective on Frequentisi Statistics.”</span> <em>Epidemiology</em> 24 (1): 62–68.
</div>
<div id="ref-greenland2016statistical" class="csl-entry" role="listitem">
Greenland, Sander, Stephen J Senn, Kenneth J Rothman, John B Carlin, Charles Poole, Steven N Goodman, and Douglas G Altman. 2016. <span>“Statistical Tests, p Values, Confidence Intervals, and Power: A Guide to Misinterpretations.”</span> <em>European Journal of Epidemiology</em> 31 (4): 337–50.
</div>
<div id="ref-jeffreys1946invariant" class="csl-entry" role="listitem">
Jeffreys, Harold. 1946. <span>“An Invariant Form for the Prior Probability in Estimation Problems.”</span> <em>Proceedings of the Royal Society of London. Series A. Mathematical and Physical Sciences</em> 186 (1007): 453–61.
</div>
<div id="ref-lecam1953some" class="csl-entry" role="listitem">
Le Cam, Lucien. 1953. <span>“On Some Asymptotic Properties of Maximum Likelihood Estimates and Related Bayes’ Estimates.”</span> <em>University of California Publications in Statistics</em> 1 (11): 277–330.
</div>
<div id="ref-pratt1965bayesian" class="csl-entry" role="listitem">
Pratt, John W. 1965. <span>“Bayesian Interpretation of Standard Inference Statements.”</span> <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 27 (2): 169–203.
</div>
<div id="ref-remein1961efficiency" class="csl-entry" role="listitem">
Remein, Quentin R, and Hugh LC Wilkerson. 1961. <span>“The Efficiency of Screening Tests for Diabetes.”</span> <em>Journal of Chronic Diseases</em> 13 (1): 6–21.
</div>
<div id="ref-tukey1960conclusions" class="csl-entry" role="listitem">
Tukey, John W. 1960. <span>“Conclusions Vs Decisions.”</span> <em>Technometrics</em> 2 (4): 423–33.
</div>
<div id="ref-wilks1938large" class="csl-entry" role="listitem">
Wilks, Samuel S. 1938. <span>“The Large-Sample Distribution of the Likelihood Ratio for Testing Composite Hypotheses.”</span> <em>The Annals of Mathematical Statistics</em> 9 (1): 60–62.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p> <a href="https://en.wikipedia.org/wiki/Joseph_Berkson">Joseph Berkson</a> (1899–1982) was an American physician and statistician at the Mayo Clinic in Rochester, Minnesota. He helped develop and popularize the use of logistic regression for binary outcomes, coining the term “logit” for the log odds in 1944. He also pioneered the study of selection bias, a special case of which is called “Berkson’s bias”. In the late 1950s and the 1960s, he argued that scientific evidence did not establish that smoking causes lung cancer.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p> This convergence follows from the <em>Laplace approximation</em> to the posterior distribution <span class="citation" data-cites="gelman2013bayesian">(<a href="references.html#ref-gelman2013bayesian" role="doc-biblioref">Gelman et al. 2013</a>)</span>. It occurs when the likelihood <span class="math inline">\(L(\theta)\)</span> has a continuous second derivative with respect to <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\theta_\true\)</span> is not on the boundary of the support of the prior distribution. These are similar to the regularity conditions for maximum likelihood estimation.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p> The <a href="https://en.wikipedia.org/wiki/Gamma_function">gamma function</a> is <span class="math inline">\(\Gamma(v) = \int_0^\infty y^{v - 1} e^{-y} \dif y\)</span>. It is used to define the gamma distribution, of which the chi-squared distributions (including <span class="math inline">\(\chi^2_1\)</span>) are special cases. If <span class="math inline">\(v\)</span> is a positive integer, then <span class="math inline">\(\Gamma(v) = (v - 1)!\)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p> <a href="https://en.wikipedia.org/wiki/Harold_Jeffreys">Harold Jeffreys</a> (1891–1989) was an English mathematician, statistician, geophysicist, and astronomer. He helped revive the Bayesian notion of probability as an expression of our knowledge about an unknown quantity, wrote a classic textbook on mathematical physics with his wife Bertha (also a mathematician and physicist), and was a prominent opponent of the theory of plate tectonics.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./mlestimation.html" class="pagination-link" aria-label="Maximum Likelihood Estimation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Maximum Likelihood Estimation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./longitudinal.html" class="pagination-link" aria-label="Longitudinal Data, Rates, and Counts">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Longitudinal Data, Rates, and Counts</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>